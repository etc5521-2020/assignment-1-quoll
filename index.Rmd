---
title: "ETC5521 Assignment 1"
subtitle: "Global astronautical exploration development"
team: quoll
author:
  - Jinhao Luo
  - Yawen Zhang
  - Brendi Ang
  - Putu Saputra
date: "`r Sys.Date()`"
bibliography: references.bib
biblio-style: apa
output: 
  bookdown::html_document2:
    citation_package: biblatex
    toc: true
---

[This assignment is for ETC5521 Assignment 1 by Team `r rmarkdown::metadata$team` comprising of `r knitr::combine_words(rmarkdown::metadata$author)`.]{style="color:#006DAE;"}

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, cache=FALSE, message=FALSE, warning=FALSE)

library(tidyverse)
library(dplyr)
library(plotly)
library(ggplot2)
library(DT)
library(htmltools)
library(patchwork) 
library(png)
```

```{r write-data, eval = FALSE}
tuesdata <- tidytuesdayR::tt_load('2020-07-14')
astronauts_origin <- tuesdata$astronauts

write.csv(astronauts_origin, here::here("data", "astronauts.csv"))
```

```{r read-data}
astronauts <- read.csv(here::here("data", "astronauts.csv"))

our_theme <- theme(rect = element_rect(fill = "#4e5a65"),
        text = element_text(color = "white", size = 10),
        panel.background = element_rect(fill = "#4e5a65"),
        axis.text = element_text(color = "white"),
        panel.border = element_rect(color = "white", size = 0.8),
        plot.title = element_text(size = 12, face = "bold", colour = "white"),
        plot.subtitle = element_text(size = 15, face = "italic", colour = "white"),
        axis.ticks = element_line(colour = "white")
        )
```

# Introduction and motivation


# Data description

The data which are used for analysing in this report are from the astronaut database. Because only one website could not contain comprehensive and up-to-date astronautic information. Therefore, this database was collected from NASA, Roscosmos, and fun-made websites, which includes information about the space mission before 15 January 2020. Furthermore, this data contains 24 different types of information about 1277 astronauts which are name, sex, year of birth, nationality, military status, the name and year of selection program, information about each mission implemented by astronaut such as year, title, ascend and decent shuttle names, duration of mission and extravehicular activity (EVAs). The version of data has been updated on 14 July 2020, which contains the astronautic information from 1961 to 2019. The data used in this report was read from the TidyTuesdayR package, and it has been saved in a new csv file called astronaut for later use.

By browsing the whole dataset and using the glimpse function to observe the variables and the corresponding classes by R, this report decides to apply this dataset into analysing the development of the astronautic industry. Meanwhile, according to the observation, the report would try to use several important and useful variables to explore the development of the astronautic industry as much as possible, like the year, number, and duration of missions, proportion of space travelers, the number of extravehicular activity and the gender of astronauts. In addition, some missing values and inappropriate classes of variables have been found, which would be considered in the following analysing part.

```{r}
astronauts_var <- astronauts %>% select(-X)
Variables <- astronauts_var %>% names()
Class <- sapply(astronauts_var, class)
Description <- c("ID",
            "Number",
            "Number within country",
            "Full name",
            "Name in original language",
            "Sex",
            "Year of birth",
            "Nationality",
            "Military status",
            "Name of selection program",
            "Year of selection program",
            "Mission number",
            "Total number of missions",
            "Occupation",
            "Mission year",
            "The title of the mission",
            "Name of ascend shuttle",
            "Name of spacecraft used in orbit",
            "Name of descend shuttle",
            "Duration of mission in hours",
            "Total duration of all missions in hours",
            "Instances of EVA by mission",
            "Duration of extravehicular activities during the mission",
            "Total duration of all extravehicular activities in hours")

tibble(Variables,Class,Description) %>%
  datatable(class = 'cell-border stripe',
          rownames = FALSE,
          filter = 'top',
          selection="multiple",
          escape=FALSE,
          options = list(pageLength = 5, sDom  = '<"top">lrt<"bottom">ip'),
          caption = htmltools::tags$caption(style = 'caption-side: bottom; text-align: center;','Table 1: ',
                    em('List of astronauts dataset variables description.')))

```




## Women performance in astronautical exploration

According to figure \@ref(fig:gender), while women have also appeared in space exploration, men have been the main force in this 49-year period. However, we cannot ignore the contribution of female astronaut in space exploration. @jacksona2019women indicated that women has preformed essential work in astronautical area since 19th century. Furthermore, @jacksona2019women also illustrated that the first women travelled into space was in 1963, and the first American female astronaut appeared in 1983. Female astronauts also contribute to the exploration same as male astronauts. 

```{r gender, fig.cap="Astronaut gender amount comparison"}
gender <- astronauts %>%
  select(year_of_mission,sex) %>% 
  group_by(year_of_mission) %>% 
  count(sex) 


gender %>% 
  ggplot() + 
  geom_bar(aes(sex, fill = sex)) + 
  scale_fill_manual(values=c("#f292e5","#9294f2"))+
  xlab("gender") + 
  ggtitle("Astronaut Gender Amount") +
  theme_linedraw()+
  our_theme
```

Female astronauts trend to increase in the space exploration. According to figure \@ref(fig:gender-percentage), although there was female astronauts appears in the space in 1963, there was a 20-year empty period for female astronauts until 1981. Such situation finished until 1982, and after that, female astronauts trend to increase in fluctuation along with year growing. And female astronauts have appeared in the astronautical exploration almost every year. 

```{r gender-percentage, fig.cap="Global gender share in astronautical exploration of each year "}
astronauts %>% 
  select(year_of_mission, sex) %>% 
  ggplot() + 
  geom_bar(aes(x = year_of_mission, fill = sex), position = "fill") + 
  scale_fill_manual(values=c("#f292e5","#9294f2"))+
  xlab("year") + 
  ggtitle("Global Gender Share") +
  theme_linedraw()+
  our_theme
``` 

Overall, female astronauts have started to appear frequently in the space exploration, and experienced a general increase tendency. However, female astronauts are still account for a low share compared with male astronauts. While, @jacksona2019women explained that the possibilities and need for more females in astronautical exploration have been considered in the worldwide nowadays. Female astronauts would trend to contribute more in the space exploration in the future, and more and more female might appear in the universe.

## Is there any female astronauts that have longer mission duration than men?

According to the \@ref(fig:gender) figure, we would like to explore more deeply the role of female astronauts in space missions. First of all, let us see how the female and male astronauts compare in total mission hour and extravehicular activity in space. If we look at Figure \@ref(fig:mission-hour-male-vs-female), two graphs show the comparison between the two. In general, female astronauts have less time than men, both on missions and extravehicular activity. The total number of days for men in (A) reaches almost 150,000 days while for women around 12,500 days. The same thing also happened to extravehicular activities (B) where the total days of women did not reach 100 days, but men were more than 500 days.

```{r mission-hour-male-vs-female, fig.cap="These two charts show the ratio of male and female astronauts in mission duration in days. The X-axis shows gender, while the y-axis shows the number of days. (A) By mission days, female have much lower duration than male, (B) In the total extravehicular activity, male have much longer to do the activity than female.", out.height="50%"}

mission_hrs <- astronauts %>%
  #create new column day of mission
  mutate(day_of_mission = total_hrs_sum / 24) %>%
  # plot the data
  ggplot(aes(x = sex, y = day_of_mission, fill = sex)) +
  geom_col() +
  scale_fill_manual(values=c("#f292e5","#9294f2"))+
  xlab("") +
  theme_linedraw() +
  # assign our theme
  our_theme +
  # add tag 
  labs(tag = "(A)", y = "Total Mission Length (in day)", color = "Sex")

eva_hrs <- astronauts %>%
   #create new column day of mission
  mutate(day_of_mission = total_eva_hrs / 24) %>%
  # plot the data
  ggplot(aes(x = sex, y = day_of_mission, fill = sex)) +
  geom_col() +
  scale_fill_manual(values=c("#f292e5","#9294f2"))+
  xlab("") +
  theme_linedraw() +
  # assign our theme
  our_theme +
  # add tag
  labs(tag = "(B)", y = "Total Extravehicular Activity (in day) ", color = "Sex")

# combine the image together side by side with the tags
mission_hrs + eva_hrs + plot_layout(guides = "collect")
```

Next, we want to map each astronaut who has undergone a space mission based on mission duration, gender, and nationality. Figure \@ref(fig:astro-plotly) is an interactive plot that can be changed based on nationality. The x-axis shows the mission duration and the y-axis shows the name. Each point in this scatter plot represents one astronaut's name.


```{r astro-plotly, fig.cap="The interactive scatter plot with filter by nationality, x-axis shows mission duration in hours and y-axis represents name of the astronauts. Hover the point to look at the details of evry astronauts."}
# create the button attributes with restyle method from plotly
button_list <-
  lapply(1:length(unique(astronauts$nationality)), function(x) {
    list(
      method = "restyle",
      args = list(paste0("transforms[0].value"), unique(astronauts$nationality)[x]),
      label = unique(astronauts$nationality)[x]
    )
  })

# assign the model and layout of the button, here we used dropdown.
type_list <-  list(
  type = 'dropdown',
  active = -1,
  xanchor = 'right',
  yanchor = "top",
  pad = list('r' = 0, 't' = 10, 'b' = 10),
  x = 1.2,
  y = 1.2,
  buttons = button_list, # assign button_list object to buttons
  font=list(color = '#ffffff'),
  activecolor = list(color="fff000")
)

# the theme of y axis
axy <- list(
  title = "Name",
  zeroline = FALSE,
  showline = TRUE,
  showticklabels = FALSE,
  showgrid = FALSE,
  color = '#ffffff'
)
# the theme of x axis
axx <- list(
  title = "Total Mission in Hours",
  zeroline = FALSE,
  showline = TRUE,
  showticklabels = TRUE,
  showgrid = FALSE,
  color = '#ffffff'
)

# make scatter plot using plotly
plot_ly(
  astronauts,
  x = ~total_hrs_sum,
  y = ~name,
  # assign nationality column as object named customdata
  customdata=~nationality,
  type = "scatter",
  mode = "markers",
  # the point will be colored based on the sex
  color = ~sex,
  # assign color palletes
  colors = c("#f292e5", "#9294f2"),
  # assign the info when hovering the point
   text = ~ paste('</br> Name: ',name,
                  '</br> Nationality: ',nationality,
                  '</br> Total Hours: ',total_hrs_sum),
   hoverinfo = "text",
  # assign the filter and the target
  transforms = list(
    list(
      type = 'filter',
      target = 'customdata',
      operation = '=',
      value = astronauts$nationality
    )
  )
) %>%
  # modify layout of the plot
  layout(updatemenus = list(type_list),
         paper_bgcolor="#4e5a65",
         plot_bgcolor ="#4e5a65",
         xaxis = axx,
         yaxis = axy,
         title = "Every Single Astronaut's Time",
         titlefont = list(color = '#ffffff'),
         legend = list(font=list(color = '#ffffff')))%>%
  # hide the plotly ModeBar 
   config(displayModeBar = FALSE)

```


```{r female-mission}
# data for male vs male in mission duration
plot_mission <- astronauts %>%
  # group the data by name and summarised them by sex, nationality, and total hours
  group_by(name) %>%
  summarize(sex = sex,
            nationality = nationality,
            total_hrs_sum = total_hrs_sum) %>%
  unique() %>%
  # arrange from highest to lowest based on total hours
  arrange(desc(total_hrs_sum)) %>%
  # create the new variable day of mission by divide total hour with 24
  mutate(day_of_mission = total_hrs_sum / 24) %>%
  # only take 15 highest data
  head(15) %>%
  # plot the data
  ggplot(aes(
    x = fct_reorder(name, total_hrs_sum),
    y = day_of_mission,
    color = sex
  )) +
  geom_point(size = 2) +
  geom_segment(aes(
    x = name,
    xend = name,
    y = 0,
    yend = day_of_mission
  ), size = 1.2) +
  scale_color_manual(values=c("#f292e5","#9294f2"))+
  theme_linedraw() +
  ggtitle("Space Mission")+
  our_theme + 
  theme(legend.key = element_rect(fill = "#4e5a65"))+
  theme(plot.title.position = "plot")+
  ylab("Mission in days")+
  labs(tag = "(A)")+
  coord_flip()
  
```

```{r female-eva-mission}
# data for male vs male in eva duration
plot_eva <- astronauts %>%
  # group the data by name and summarised them by sex, nationality, and total hours
  group_by(name) %>%
  summarize(sex = sex,
            nationality = nationality,
            total_eva_hrs = total_eva_hrs) %>%
  unique() %>%
  # arrange from highest to lowest based on total hours
  arrange(desc(total_eva_hrs)) %>%
    # create the new variable day of mission by divide total hour with 24
  mutate(day_of_mission = total_eva_hrs / 24) %>%
    # only take 15 highest data
  head(15) %>%
  # plot the data
  ggplot(aes(
    x = fct_reorder(name, day_of_mission),
    y = day_of_mission,
    color = sex
  )) +
  geom_point(size = 2) +
  geom_segment(aes(
    x = name,
    xend = name,
    y = 0,
    yend = day_of_mission
  ), size = 1.2) +
  theme_linedraw() +
  scale_color_manual(values=c("#f292e5","#9294f2"))+
  ggtitle("Eva Activity")+
  our_theme +
  theme(legend.key = element_rect(fill = "#4e5a65"))+
  theme(plot.title.position = "plot")+
  ylab("Mission in days")+
  labs(tag = "(B)")+
  coord_flip()
```

From the interactive plot above, at a glance, we can see that there is a female astronaut who has a high enough mission time. Therefore, we will next present the 15 astronauts with the highest mission duration and spacewalk. In Figure \@ref(fig:astro-15) there are two plots A and B. Plot A shows the space mission while plot B shows extravehicular activity among astronauts. In Plot A, there is one female astronaut who is in ninth place, namely Peggy A. Whitson. Peggy has gone on space expeditions for a total of 665 days. Also, in plot B, we can see that Peggy is in fourth place in the spacewalk mission with a total time of 2.5 days. Another woman Astonot is Sunita L. Williams who is in tenth place. Sunita set out on a mission in 2006 and 2012 with a total extravehicular activity time of 2 days.

```{r astro-15, fig.cap="The lollipop graph that shows fifteen top astronauts based on mission times and extravehicular activity. (A) Whitson Peggy is the only female astronauts that sit on big nine in longest mission time, (B) Whitson Peggy and William SUnita are the only female astronauts that have more extravehicular activity in top fifteen", out.width="100%", out.height="60%"}
# combined the plots side by side
plot_mission+plot_eva+plot_layout(guides = "collect", heights = 100)
```

Peggy A. Whitson and Sunita L. Williams in Figure \@ref(fig:whitson-sunita), are American astronauts. Reported from @mars_peggy_2015, "Peggy completed two six-month tours of duty aboard the station for Expedition 5 in 2002, and as the station commander for Expedition 16 in 2008 where she accumulated 377 days in space between the two missions, the most for any US. woman at the time of her return to Earth." Another interesting fact from Peggy is that stated in @potter_record-setting_2018, in 2008, Whitson returned on Expedition 16 and became the first female commander of the space station. @potter_record-setting_2018 report that Peggy announced her retirement on June 16, 2018. 

@whiting_sunita_2016 explained that Sunita L Williams is a female astronaut selected by NASA in 1998 who has carried out two space missions Expeditions 14/15 and 32/33. Reported by @whiting_sunita_2016, now she is preparing for her third long-duration mission aboard the International Space Station. 

```{r whitson-sunita, fig.align='center', fig.cap=' **Left** : Peggy A. Whitson (Ph.D.), the U.S. record holder, placing eighth on the all-time space endurance list. **Right** : Sunita L. Williams, a veteran of two space missions Expeditions 14/15 and 32/33 (source:NASA)'}

library(png)
img <- readPNG("data/whitson-sunita.png")
grid::grid.raster(img)
```

Apart from Peggy and Sunita, there are many female astronauts from various countries who have carried out space missions. The rest can be seen in Table 3 below.

```{r}
# a custom table container
sketch = htmltools::withTags(table(
  class = 'display',
  thead(
    tr(
      th(colspan = 2, 'Profile'),
      th(colspan = 4, 'Mission Time'),
    ),
    tr(
      lapply(rep(c('Name','Sex','Nationality','Mission', 'Extravehicular'), 1), th)
    )
  )
))

astronauts %>%
  filter(sex=="female") %>%
  # group the data by name and summarised them by sex, nationality, and total hours
  group_by(name) %>%
  summarize(sex = sex,
            nationality = nationality,
            total_hrs_sum = total_hrs_sum,
            total_eva_hrs = total_eva_hrs) %>%
  unique() %>%
  # arrange from highest to lowest based on total hours
  arrange(desc(total_hrs_sum)) %>%
  datatable(class = 'cell-border stripe',
          container = sketch,
          rownames = FALSE,
          filter = 'top',
          selection="multiple",
          escape=FALSE,
          options = list(pageLength = 5, sDom  = '<"top">lrt<"bottom">ip'),
          caption = htmltools::tags$caption(style = 'caption-side: bottom; text-align: center;','Table 3: ',
                    em('List of Female Astronauts.')))
```

We want to see the background of the female astronaut in the dataset. In Figure \@ref(fig:figures-side) two graphs show a summary of the background of the female astronaut. In figure (A), astronauts with a civilian background dominate the military. A total of 106 came from civilian and 37 from the military.
Furthermore, in figure (B), 106 people who come from civilian are MSP (Mission Specialist). Based on @nasa_selection , Mission Specialists are working closely with the commander and pilot, are responsible for coordinating onboard operations involving crew activity planning.  Furthermore, 20 people were flight engineers, 7 were pilots, 3 were flight commander, and 5 were PSP (Payload Specialist). @nasa_selection stated that Payload Specialist is a professional in the physical or life sciences or a technician skilled in operating Shuttle-unique equipment. What is interesting about this plot is that there are two people who are Space Tourist.

They are Anousheh Ansari, an American businesswoman and Lee So Yeon from South Korea. Reported in @nasa_expedition, "American businesswoman Anousheh Ansari will fly with the Expedition 14 crew to the International Space Station as a spaceflight participant." @nasa_expedition explained that she spent nine days on the station under a commercial agreement with the Russian Federal Space Agency (Roscosmos) and returned to Earth with the Expedition 13 crew. In that expedition, she was with Sunita Williams on board.

Meanwhile based on @nasa_2012_international, Lee So Yeon is the first South Korean female astronaut to fly into space. Reported by NASA, she was selected from among 36,000 applicants to serve as her nation's first astronaut. @nasa_2012_international stated that she flew on Soyuz TMA-12 to the International Space Station (ISS) on April 8, 2008, returning to Earth 10 days later. 



```{r figures-side, fig.cap="The bar graph shows female astronauts background, (A) More astronauts comes from civilian than military fields, (B) MSP is a dominant occupation and there are small number of Space Tourist", fig.show="hold", out.width="50%"}
astronauts %>%
  filter(sex=="female") %>%
  group_by(sex, military_civilian) %>%
  tally() %>%
  ggplot(aes(x = military_civilian, y = n, fill = sex)) +
  geom_col()  + 
  scale_fill_manual(values=c("#f292e5"))+
  theme_linedraw()+
  our_theme+
  theme(legend.position = "none")+
  ylab("")+
  xlab("")+
  labs(tag = "(A)", title = "Military Civilian Background")

astronauts$occupation[astronauts$occupation == "Other (space tourist)"] <-
  "Space Tourist"
astronauts$occupation[astronauts$occupation == "Space tourist"] <-
  "Space Tourist"
astronauts$occupation[astronauts$occupation == "Other (Space tourist)"] <-
  "Space Tourist"
astronauts$occupation <- tools::toTitleCase(astronauts$occupation)

astronauts %>%
  filter(sex=="female") %>%
  group_by(sex, occupation) %>%
  tally() %>%
  ggplot(aes(x = fct_reorder(occupation,n), y = n, fill = sex)) +
  geom_col()+
  scale_fill_manual(values=c("#f292e5"))+
  theme_linedraw() +
  our_theme+
  ylab("")+
  xlab("")+
  labs(tags="(B)", title = "Occupation Background")
```


# Conclusions 

From the first humans have accomplished an orbital spaceflight in 1961 (@corlett2020population), to the intensity of launched reached a record figure in 1980s, the astronautical industry has experienced a continuous development. The interesting and enthusiasm of human for universe have prompted the development of astronautical industry. Whether based on the number of projects and missions launched for astronautical exploration, as well as the appearance of female astronauts and more countries join in the space exploration, the astronautical industry has showed the great development to human. 

The astronautical exploration projects and missions experienced a increase trend since the first humans appeared in the universe. And there were a space exploration rush lasted almost 24 years in the world. In that period, the number of project and mission are the highest level from 1961 to today. Meanwhile, many countries also join in the project of the astronautical exploration, which might contribute the development of the space exploration. 

Furthermore, the technologies of the space exploration also have developed. Through the spaceflight activities of space travelers exploration, the overall EVA number steadily increased ten years before, but it decreased in recent years. However, it does not mean the development of the spaceflights is regressing. Since the launch of the ISS program in 1998 (@NASA), the duration of almost each mission task is more than 480 hours.

Besides, female astronauts also appear in the history of astronautical exploration. Although male astronauts dominate the number of astronauts who go on missions to space, actually some female astronauts have longer mission time than men. Whitson A. Peggy and Williams Sunita are the veteran female astronauts who are among the top fifteen astronauts who have the most extended mission and extravehicular activity over the year. Another fact that emerges is that more female astronauts come from civilians than from the military.

# Acknowledgement

The programming language used to analyse the trends of global astronautical exploration is R (4.0.2) [@R]. And the platform which used for running R language is Rstudio (1.3.1056) [@Rstudio].

Following packages has been included in our Rmd file.

- package tidyverse (1.3.0) [@tidyverse],
- package dplyr (1.0.1) [@dplyr],
- package plotly (4.9.2.1) [@plotly],
- package ggplot2 (3.3.2) [@ggplot2]


# References
