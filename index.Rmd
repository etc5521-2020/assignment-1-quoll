---
title: "ETC5521 Assignment 1"
subtitle: "Astronaut Database"
team: quoll
author:
  - Jinhao Luo
  - Yawen Zhang
date: "`r Sys.Date()`"
output: 
  bookdown::html_document2
---

[This assignment is for ETC5521 Assignment 1 by Team `r rmarkdown::metadata$team` comprising of `r knitr::combine_words(rmarkdown::metadata$author)`.]{style="color:#006DAE;"}


```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, cache=FALSE, message=FALSE, warning=FALSE)

library(tidyverse)
library(dplyr)
library(reshape2)
```

```{r write-data, eval = FALSE}
tuesdata <- tidytuesdayR::tt_load('2020-07-14')
astronauts_origin <- tuesdata$astronauts

write.csv(astronauts_origin, here::here("data", "astronauts.csv"))
```

```{r read-data}
astronauts <- read.csv(here::here("data/astronauts.csv"))
```


# Introduction and motivation

[FILL] Give the bigger picture of the data, and inspire the reader to learn more about the problem by reading your analysis. 

# Data description

The data which are used for analysing in this report are from the astronaut database. Because only one website could not contain comprehensive and up-to-date astronautic information. Therefore, this database was collected from NASA, Roscosmos, and fun-made websites, which includes information about the space mission before 15 January 2020. Furthermore, this data contains 24 different types of information about 1277 astronauts which are name, sex, year of birth, nationality, military status, the name and year of selection program, information about each mission implemented by astronaut such as year, title, ascend and decent shuttle names, duration of mission and extravehicular activity (EVAs). The version of data has been updated on 14 July 2020, which contains the astronautic information from 1961 to 2019. The data used in this report was read from the TidyTuesdayR package, and it has been saved in a new csv file called astronaut for later use.

By browsing the whole dataset and using the glimpse function to observe the variables and the corresponding classes by R, this report decides to apply this dataset into analysing the development of the astronautic industry. Meanwhile, according to the observation, the report would try to use several important and useful variables to explore the development of the astronautic industry as much as possible, like the year, number, and duration of missions, proportion of space travellers, the number of extravehicular activity and the gender of astronauts. In addition, some missing values and inappropriate classes of variables have been found, which would be considered in the following analysing part.

Therefore, the development of the world astronautic exploration with time from the first spaceflight launched would be the primary question of this report. In addition, the report would also focus on three secondary questions. Firstly, When does astronautic exploration become more competitive? Secondly, How is the tech of astronautic exploration development? Thirdly,  Do females also play an important role in astronautic exploration, when does the first female astronaut appear in international astronautic exploration?


# Analysis and findings

[FILL] Should include at least one plot or numerical summary for each of your questions, that helps the reader arrive at an answer. You should also write paragraphs describing the methods, summaries and findings. 


## Number of extravehicular (EVA) operations per year

This Figure \@ref(fig:plotEVA) describe the Number of extravehicular (EVA) operations per year. Add up all the EVA in the same year and make this bar chart. Since the first spacewalk performed by Alexei Leonov in 1965, the number of extravehicular activity (EVA) was performed steadily increased especially around year 2000 over than 300 times per year. After year 2000, the number of times of EVA has decreased, it does not mean that the development of spacefights is regressive. Figure \@ref(fig:plotmissionhours) shows the execution duration for each mission and the results is dramatically increased.  

```{r select-raw-data}
EVA_number_year <- astronauts %>%
  select(year_of_mission, eva_hrs_mission) %>%
  #arrange(year_of_mission)
  group_by(year_of_mission) %>%
  summarise(sum(eva_hrs_mission)) %>%
  rename(Total = `sum(eva_hrs_mission)`, Year = year_of_mission)
```

```{r plotEVA, fig.cap="Number of EVA operation per year"}
EVA_number_year %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_bar(stat="identity") +
  theme(panel.grid.major =element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(),axis.line = element_line(colour = "black")) +
  ylab("Number of EVA") +
  ggtitle("Number of extravehicular (EVA) operations per year")
```


## Proportion of Space Travelers in Different Spaceflights

Based on the article written by Corlett,  Stavnichuk and Komarova in 2020, divided the duration of mission hours into three categories could observe the progress of space traveler more intuitively. These three categoris include pariticipant short spacelights less than 96 hours, intermediate spaceflights between 96 to 480 hours and long spaceflights more than 480 hours. When the spaceflights first developed, all the duration of mission is less than 96 hours. After that the time astronauts spent in space increased through the spaceflights histories. The recent trend is the time spent on each mission exceeds 480 hours which shows in Figure \@ref(fig:plotmissionhours). The potential reason related to the launch of the International Space Station (ISS) progrom in 1998 (NASA, 2017). 
```{r}
# astronauts %>%
#   select(year_of_mission, hours_mission) %>%
#   group_by(year_of_mission) %>%
#   summarise(sum(hours_mission))
```

```{r total-astronausts}
total_astronauts <- astronauts %>%
  select(name, year_of_mission, hours_mission) %>%
  arrange(year_of_mission) %>%
  count(year_of_mission)
```  
  
```{r mission-less-96h}  
astronauts_96 <- astronauts %>%
  select(year_of_mission, hours_mission) %>%
  filter(hours_mission < 96 ) %>%
  count(year_of_mission)
```

```{r join-96-total}
join_96 <- full_join(astronauts_96,total_astronauts,  by = "year_of_mission") %>%
  arrange(year_of_mission)

join_96[is.na(join_96)] <- 0
prop_96 <- join_96 %>%
  rename("number96" = n.x, total = n.y) %>%
  mutate(proportion_96 = (number96 / total)) %>%
  select(year_of_mission, proportion_96)
```



```{r mission-between-96-480h}
astronauts_96_480<- astronauts %>%
  select(year_of_mission, hours_mission) %>%
  # mutate(total = sum(year_of_mission)) %>%
  filter(hours_mission > 96 & hours_mission < 480) %>%
  count(year_of_mission)
```

```{r join--96-480-total}
join_96_480 <- full_join(astronauts_96_480, total_astronauts, by = "year_of_mission") %>%
  arrange(year_of_mission)

join_96_480[is.na(join_96_480)] <- 0 
prop96_480 <- join_96_480 %>%
  rename("number96_480" = n.x, total = n.y) %>%
  mutate(proportion96_480 = (number96_480 / total)) %>%
  select(year_of_mission, proportion96_480)
```

```{r mission-over-480h}
astronauts_480 <- astronauts %>%
  select(year_of_mission, hours_mission) %>%
  # mutate(total = sum(year_of_mission)) %>%
  filter(hours_mission > 480) %>%
  count(year_of_mission)
```

```{r join-three-tables}
join_480 <- full_join(astronauts_480, total_astronauts, by = "year_of_mission") %>%
  arrange(year_of_mission)

join_480[is.na(join_480)] <- 0 
prop_480 <- join_480 %>%
  rename("number480" = n.x, total = n.y) %>%
  mutate(proportion_480 = (number480 / total)) %>%
  select(year_of_mission, proportion_480)
```

```{r plotmissionhours, fig.cap="Proportion of space travelers in different spaceflights"}
mission <- full_join(prop_96, prop96_480, by = "year_of_mission") %>%
  full_join(prop_480, by = "year_of_mission") %>%
  rename("< 96h" = proportion_96, "96 to 480h" = proportion96_480, "> 480h" = proportion_480)

mission1 <- mission %>%
  pivot_longer("< 96h":"> 480h", names_to = "categories", values_to = "proportion") %>%
  mutate(categories = as_factor(categories)) %>%
  rename("Categories" = "categories")
# mutate(categories = fct_relevel(categories, c("96 to 480h", "> 480h", "< 96h")))

ggplot(mission1, aes(year_of_mission, proportion, Categories, fill = Categories)) +
  geom_bar(stat="identity",position="fill") +
  scale_fill_manual("Categories", values = c("96 to 480h" = "#F5B041", "< 96h" = "#F5CBA7", "> 480h" = "#D35400")) +
  ggtitle("Proportion of space travelers that participated in short, intermediate and long spaceflights")+
  theme(panel.grid.major=element_line(colour=NA)) +
  xlab("Year") +
  ylab("Proportion of Astronauts") +
  theme(text = element_text(size = 9), axis.title.x = element_text(size = 12), axis.title.y = element_text(size = 12))
```


# References
