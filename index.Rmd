---
title: "ETC5521 Assignment 1"
subtitle: "Global astronautical exploration development"
team: quoll
author:
  - (Jinhao Luo)
  - (Yawen Zhang)
  - Brendi Ang
  - Putu S
date: "`r Sys.Date()`"
output: 
  bookdown::html_document2:
    theme: darkly
    citation_package: biblatex
    toc: true
    number_sections: false
    toc_float:
      collapsed: yes 
bibliography: references.bib
biblio-style: apa
link-citations: yes
---

[This assignment is for ETC5521 Assignment 1 by Team `r rmarkdown::metadata$team` comprising of `r knitr::combine_words(rmarkdown::metadata$author)`.]{style="color:#006DAE;"}

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, cache=FALSE, message=FALSE, warning=FALSE)

library(tidyverse)
library(dplyr)
library(geomnet)
library(plotly)
library(ggplot2)

# Set theme for graphs
our_theme <- theme(rect = element_rect(fill = "#4e5a65"),
        text = element_text(color = "white", size = 10),
        panel.background = element_rect(fill = "#4e5a65"),
        axis.text = element_text(color = "white"),
        panel.border = element_rect(color = "white", size = 0.8),
        plot.title = element_text(size = 12, face = "bold", colour = "white"),
        plot.subtitle = element_text(size = 15, face = "italic", colour = "white"),
        axis.ticks = element_line(colour = "white")
        )
```

```{r write-data, eval = FALSE}
tuesdata <- tidytuesdayR::tt_load('2020-07-14')
astronauts_origin <- tuesdata$astronauts

write.csv(astronauts_origin, here::here("data", "astronauts.csv"))
```

```{r read-data}
astronauts <- read_csv(here::here("data", "astronauts.csv"))
```

# Introduction and motivation

Since Yury Gargarin became the first man in space in 1961, space probes have explored the solar system and have discovered thousands of planets around other stars. For instance, we may not have wireless headphones or even camera phones without these space research and explorations (@green2019). Over the years, many milestones have been achieved around thee world through space travel and exploration. 

From the start, the U.S. and Russian astronauts (cosmonauts) have been the pioneers and forefront of space explorations, leading most of the space expeditions. Unfortunately, the start of space explorations in 1961 begun with an ongoing political rivalry between the U.S. and the Soviet Union (Russia), which developed after World War II; This time frame was more known as the 'Cold War' (@brown2011american).

This report will critically analyse the historical timeline of space explorations and the demographics of astronauts. First, the trends in space missions and astronaut training will be explored by highlights space exploration breakthroughs such as the establishment of the International Space Station and the NASA Space Shuttle Program. Next, international collaboration will be discussed by considering collaborative missions and breaking down the historical timeline into decades to further explore pre and post Cold-War eras Last but not least, the social demographics of astronauts will be studied, with emphasis on the role of female astronauts based on the duration spent in space missions. Further, we will mention female astronauts with exceptional space records that exceeded most male astronauts such as Peggy A. Whitson and Sunita L. Williams. Lastly, the military status and occupations of astronauts will be addressed.

The report can be summarised into one primary question and three secondary question:  
- How has Space Exploration Evolved Through Time?  
  - With the advancements in technological and scientific fields, what are the trends in space missions?  
  - Are there more international Collaboration?  
  - With a large disparity in male and female astronauts, is there a difference in space mission times too?  

# Analysis and Findings

# Space Exploration

## Total Space Missions and Hours Embarked

```{r yearly-total-projects, fig.cap = "An overview of the total space missions each year. The x-axis denotes the year of mission and the y-axis shows the total number of missions. It can be observed that there is a steady increase in total space missions till year 2000 before it gradually decreased."}
# Total projects Over the Years
astronauts %>%
  group_by(year_of_mission) %>%
  tally() %>%
  ggplot(aes(x = year_of_mission,
               y = n)) +
  geom_col(fill = "grey",
           colour = "black") +
  geom_smooth(method = "gam",
              color = "#FFD900",
              size = 0.5) +
  scale_x_continuous(breaks = seq(from = 1960, to = 2020, by = 5),
                     labels = seq(from = 1960, to = 2020, by = 5)) +
  labs(x = "Year of Mission",
       y = "Total Number of Missions",
       title = "Total Number of Missions per Year") +
  theme_linedraw() +
  our_theme 
```

Since the solo expedition of Yuri Alekseyevich Gagarin space mission on 12 April 1961 to the to the Apollo 11 lunar landing in 1969, mankind has grown a stark interest in space exploration (@corlett2020population). In this first mission, his capsule orbited the Earth for approximately 90 minutes before making a safe landing back on the planet; This marked a crucial step for the development of space exploration. 

Based on Figure \@ref(fig:yearly-total-projects), the total number of missions have increased gradually before decreasing at about year 2000. It can be observed that the total number of missions was at its peak in year 1985; This period was known as the era of the NASA space shuttle. Over three decades, this space shuttle program hosted a total of 135 flights, where the final shuttle flight, NASA's STS-135 landed on 21 July 2011 (@national2011preparing). It is manifest that the total number of missions dropped dramatically after the discontinuation of the program. 

Not to mention, Figure \@ref(fig:yearly-total-projects) shows a drastic decrease in space missions from 1985 to 1989. This is attributed to the Space Shuttle Challenger disaster, where the U.S. space shuttle broke apart 73 seconds into its flight, killing all seven crew members aboard (@challenger2019). For that reason, the Space Missions in the NASA space shuttle program were halted for two years, which caused the dramatic decline in space missions in 1986 - 1989.


```{r yearly-mission-duration, fig.width = 8, fig.cap = "An overview of the total durations of all space missions for a given year. The x-axis represents the year of mission and the y-axis shows the distribution of the hours spent in each space mission. On an overall level, there is a gradual increase in the duration of space missions."}

# Total Duration (in hours) per Year
astronauts %>%
  ggplot(aes(x = year_of_mission,
           y=total_hrs_sum)) +
  geom_boxplot(aes(group = year_of_mission),
               color = "black",
               fill = "#d3d3d3",
               width = 0.8,
               outlier.color = "cornsilk",
               outlier.alpha = 0.3,
               outlier.size = 0.8
               ) +
  # Add Generalised additive model (GAM)
  geom_smooth(method = "gam",
              color = "#FFD900",
              size = 0.5) +
  labs(x = "Year Of Space Mission",
       y = "Total Duration (in hrs) Spent in Space for a given Year",
       title = "Total Duration of all missions for a Given Year") +
  theme_linedraw() +
  our_theme +
  scale_x_continuous(breaks = seq(from = 1960, to = 2020, by = 5),
                     labels = seq(from = 1960, to = 2020, by = 5))
```

With the developments in the medical, technological and scientific fields, astronauts are spending more number of hours in space on average, despite the decrease in the total number of space missions over the years Figure \@ref(fig:yearly-mission-duration). Moreover, the duration of space missions reached unparalleled levels in the recent years as compared to the earlier decades.

This has been made possible with advances in space technologies, which have led to the development of increasingly sophisticated space infrastructures, transport systems and space probes. Naturally, these enhanced space assets and increased human knowledge will provide more avenues for different and more greater opportunities for the space frontier. For instance, the first rudimentary International Space Station was launched in 1998 opened up extensive experience, research and technology and enhanced infrastructure for other envisioned projects in support of human exploration and the development of space (@KrishenKumar2009ECTN). 


## Lead Time Required for Astronaut Training

```{r first-missions, fig.height = 6, fig.cap = "The plot shows the total number of astronauts embarking on their first space mission for a given year. The y-axis shows the total astronauts count and the corresponding x-axis depicts the year of the mission. Contrary to the increase in the total durations in space missions in recent years, new astronauts embarking on space missions were rather stagnant due to an extended training time"}

# filter to first space flights
astronauts %>%
  filter(total_number_of_missions == 1) %>%
  group_by(year_of_mission) %>%
  tally() %>%
  ggplot(aes(x = year_of_mission,
               y = n)) +
  geom_col(fill = "#d3d3d3",
           colour = "black") +
  geom_smooth(method = "lm",
              color = "#FFD900",
              size = 0.5) +
  labs(x = "Year of Mission",
       y = "Total Astronauts",
       title = "Total Number of Astronauts' First Space Missions") +
  theme_linedraw() +
  our_theme +
  scale_x_continuous(breaks = seq(from = 1960, to = 2020, by = 5),
                     labels = seq(from = 1960, to = 2020, by = 5))
```

With the establishment of the International Space Station and growing array of opportunities in space exploration, one would expect more new astronauts embarking on space missions. However, Figure \@ref(fig:first-missions) illustrates that the amount of new astronauts embarking in space missions does not reflect the progressive increase in space mission durations as observed in Figure \@ref(fig:yearly-mission-duration). This trend highlights the lead time required to train an astronaut through a basic and mission-specific training syllabus. On average, the induction program to be a fully qualified astronaut takes approximately 2 - 4 years, usually contingent on the astronaut's military status (@national2011preparing). Some research even suggested that the time commitment and additional skill sets of astronauts as analogous, despite the difference in the technical nature of training for these professionals (@ball2008surgeons).

# Astronauts Across the Globe (incomplete)

```{r}
# * Show map if possible
# Increasing Number of participating countries
astronauts %>%
  # arrange year in ascending order
  arrange(year_of_mission) %>%
  # Find cumulative sum of participating countries
  mutate(cum_unique_entries = cumsum(!duplicated(nationality))) %>%
  ggplot() +
  geom_col(aes(x = year_of_mission, 
               y = cum_unique_entries),
           position = "identity",
           colour = "black",
           fill = "light grey") +
  theme_linedraw() +
  our_theme +
  labs(x = "Year of Mission", 
       y = "Total Participating Countries",
       title = "Increase in Participating Countries over the Years") +
  scale_x_continuous(breaks = seq(from = 1960, to = 2020, by = 5),
                     labels = seq(from = 1960, to = 2020, by = 5))
```


```{r countries-bar-chart, fig.cap= "The global percentage of each country's mission"}
astronauts %>%
  mutate(nationality = ifelse(nationality == "U.S." | nationality=="U.S.S.R/Russia", 
                              nationality, 
                              "other")) %>%
  ggplot() + 
  geom_bar(aes(x = year_of_mission, 
               fill = nationality), 
           colour = "black",
           position = "fill",
           alpha = 0.6) + 
  scale_fill_manual(values = c("#52cc00","#92b4f2", "#df9797")) + 
  xlab("Year") + 
  ylab("Count") + 
  theme_linedraw() + 
  theme(legend.position = "bottom") +
  our_theme +
  ggtitle("Global Mission Percentage") +
  scale_x_continuous(breaks = seq(from = 1960, to = 2020, by = 5),
                     labels = seq(from = 1960, to = 2020, by = 5))
```

Figure \@ref(fig:countries-bar-chart) demonstrates that the proportion of missions embarked per year were mostly dominated by U.S. astronauts, followed by the Russian cosmonauts. Further, these two countries were the only participating astronauts up till 1977, where Germany, Poland and Czechoslovakia astronauts ventured on their first space mission. Since then, it can be observed that many other countries joined the world in space exploration. This plot further display the rise in the astronauts count from other countries. Nevertheless, the U.S. were still the pioneer and had been leading the world in this astronautical field for the last few decades.

# International Collaboration 

## The Cold War Rivalry (1957 - 1991)

```{r single-country-wrangle}
single_country_missions <- astronauts %>%
  select(mission_title, nationality, year_of_mission) %>%
  group_by(year_of_mission, mission_title) %>%
  filter(n_distinct(nationality) == 1) %>%
  summarise(total_single_country_missions = n())

# Find total missions per year
total_missions <- astronauts %>%
  group_by(year_of_mission) %>%
  summarise(total_missions = n()) %>%
  ungroup() %>%
  # Join with single country missions data frame
  left_join(single_country_missions, by = "year_of_mission") 

total_missions <- total_missions %>%
  # Convert to numeric to replace NA
  mutate(across(where(is.integer), as.numeric)) %>%
  # Replace NAs with 0
  mutate(total_single_country_missions = if_else(condition = is.na(total_single_country_missions), 
                                                 true = 0,
                                                 false = total_single_country_missions)) %>%
  # Group numeric variables together
  relocate(total_missions, .after = total_single_country_missions) 

# Compute collaborated missions and proportion of single country missions
total_missions <- total_missions %>%
  mutate(total_collab_missions = total_missions - total_single_country_missions) %>%
  relocate(total_collab_missions, .before = total_missions) 

# Make long format for plotting
total_missions_long <- total_missions %>%
  pivot_longer(cols = total_single_country_missions:total_missions,
               names_to = "mission",
               values_to = "total_mission_count")
```

```{r plot-single-countries}
total_missions_long %>%
  filter(mission != "total_missions") %>%
  ggplot() +
  geom_col(aes(x = year_of_mission,
               y = total_mission_count,
               fill = mission),
           stat = "identity",
           position = "fill") + 
  labs(x = "Year of Mission",
       y = "Proportion of Single-country Missions",
       title = "Proportion of Single-Country Space Missions Against Collaborate Missions") +
  scale_fill_brewer() +
  theme_bw() +
  theme(legend.position = "bottom") +
  our_theme +
  theme(panel.grid = element_blank()) +
    scale_x_continuous(breaks = seq(from = 1960, to = 2020, by = 5),
                     labels = seq(from = 1960, to = 2020, by = 5)) 
```

The 'Cold War Rivalry' was a term to describe the animosity between the Soviet Union (U.S.S.R) and the United States (US) for the supremacy in spaceflight capability. This bumpy relationship lasted till 1991, often was characterized by periods of mistrust and overt hostility, where early schedules were driven by the cold war 'Space Race', rather than cooperation (@brown2011american).

Figure \@ref(fig:plot-single-countries) indicates this animosity in relationship; In this cold war period (1957 - 1991), single country space missions were noticeably more during this period. In some 1964 and 1966, all space missions consisted only of single country missions. Over the years, nations recognised how international cooperation has the potential to provide significant benefits to all participants, particularly if managed well. 

## International Collaboration Post Cold-War

```{r sample-wrangling, message = FALSE, include = FALSE}
# Find missions with more than 1 astronaut
missions <- astronauts %>%
  select(mission_title, nationality) %>%
  group_by(mission_title) %>%
  tally() %>% # Total number of astronauts in a mission
  filter(n > 1) %>% # Filter to missions with more than 1 astronaut
  select(-n) # Remove count number

# Select astronauts number& mission title they embarked on 
ast_number <- astronauts %>%
  # Remove row with NA mission title 
  filter(!mission_title == "NA") %>% 
  # Select astronaut number, astronaut name, mission_title
  select(mission_title, number, nationality) 

# Join tables to find astronauts who embarked in mission with more than one astronaut
sample <- left_join(missions, ast_number, by = "mission_title") 
```

```{r sample-combinations, include = FALSE}
# Create data frame with combinations of all astronaut numbers in each mission
## Astronaut number: unique identifier for each astronaut
sample <- sample %>% 
  group_by(mission_title) %>% 
  do(data.frame(t(combn(.$number, 2)))) %>%
  # Rename variables
  rename(number = X1,
         with_number = X2)
```

```{r}
# Select unique astronaut names and relevant variables for analysis
ast_names <- astronauts %>%
  select(mission_title, number, name, sex, nationality, year_of_mission) %>%
  unique()

# Left join to insert names of astronauts into combination
sample_cmbs <- sample %>%
  left_join(ast_names, by = c("mission_title", "number")) %>% # Join by 1st astronaut in a pair
  left_join(ast_names, by = c("mission_title", "with_number" = "number")) %>%
  # rename variables for both astronauts in each pair
  rename(name = name.x, 
         with_name = name.y,
         nationality = nationality.x,
         with_nationality = nationality.y, 
         sex = sex.x,
         with_sex = sex.y,
         year_of_mission = year_of_mission.x) %>%
  select(-year_of_mission.y) # remove same variable

# If astronaut not from US or Russia, categorised as 'Other'
sample_cmbs <- sample_cmbs %>%
  # First astronaut
  mutate(nationality = if_else(condition = nationality %in% c("U.S.S.R/Russia", "U.S."),
                               true = nationality,
                               false = "Other"),
         # Second astronaut
         with_nationality = if_else(condition = with_nationality %in% c("U.S.S.R/Russia", "U.S."),
                               true = nationality,
                               false = "Other"),
         # Categorise mission years into decades
         mission_decade = case_when(
           between(year_of_mission, 1960, 1969) ~ "1960 (Cold-War)",
           between(year_of_mission, 1970, 1979) ~ "1970 (Cold-War)",
           between(year_of_mission, 1980, 1989) ~ "1980s (Cold-War)",
           between(year_of_mission, 1990, 1999) ~ "1990s (Post Cold-War)",
           between(year_of_mission, 2000, 2009) ~ "2000s (Post Cold-War)",
           between(year_of_mission, 2010, 2019) ~ "2010s (Post Cold-War)"
         )
         )
```

```{r network-graph, echo = FALSE, message = FALSE, fig.width = 12}
set.seed(10001) 

sample_cmbs %>%
  ggplot() +
  geom_net(aes(from_id = name,
               to_id = with_name,
               colour = nationality,
               group = mission_title),
           layout.alg = "fruchtermanreingold",
           alpha = 0.05,
           labelon = FALSE,
           size = 1.5, # increase size of dot points
           linewidth = 0.2,
           ecolour = "grey60", # Change edge colour
           ealpha = 0.5) +
  scale_colour_manual(values = c("#b7ff49", "#92b4f2", "#df9797")) +
  facet_wrap(~ mission_decade,
             ncol = 3) +
  labs(color = "Austronaut's Nationality",
       # Change legend title
       title = "International Collaboration of Astronauts in Space Missions Across the Decades",
       subtitle = "In Space Missions with 2 or more Astronauts") + 
  theme_net() +
  theme(legend.position = "bottom", 
        legend.direction = "horizontal", # Adjust legend layout
        legend.title = element_text(color = "white", size = 10), # Change size of text in legend title
        legend.text = element_text(color = "white", size = 10), # Change size of text in legend title
        legend.background = element_rect(fill = "#3d3d3d"), # change legend background
        legend.key.size = unit(1, "cm"), # Adjust size of legend
        plot.background = element_rect(fill = "#4e5a65"), # grey background for plot
        plot.title = element_text(size = 20, face = "bold", colour = "white"), # Adjust title
        plot.subtitle = element_text(size = 15, face = "italic", colour = "white"), # Adjust subtitle
        strip.text.x = element_text(size = 12, colour = "white"), # Change facet labels
        strip.background = element_rect(fill="#474747") # Change facet background 
  ) +
  guides(color = guide_legend(override.aes = list(size = 5))) # Adjust size of shape in legend key
```

In this Figure \@ref(fig:network-graph), we have split the time frames into distinct time frames characterised by a decade. The "Cold War Period" are represented in the first row of the top panel, spanning all the way from 1960 - 1990. Correspondingly, the next row represents the "Post Cold-War) time frame.

### Cold-War Period

In the 1960 - 1980, there are noticeably less space missions as it was the beginning of the space exploration era. However, the animosity between the U.S. and Soviet Union astronauts are manifest in these decades as there were no collaboration and the U.S and Russian astronauts worked exclusively with one another. 

As mentioned in the previous sections, the late 1970s marked the emergence of astronauts of other nationalities (besides U.S. and Russian). Based on Figure \@ref(fig:network-graph), it can be observed that these new countries only went on space missions exclusively with the U.S. and the Russians but not within their countries. It can be implied that they were fairly new to space exploration. Furthermore, we see an significant increase in space missions in this decade, which may be attributed to the establishment of the NASA space shuttle program as mentioned in Figure \@ref(fig:yearly-total-projects).

### Post Cold-War: Stepping Stones towards Global Space Exploration 

From 1990 to 2019, international collaboration increased exponentially, with 35 new international partnerships over this period of time (@national2011preparing). Furthermore, the late 1990s marked the launch of the International Space Station. 

These emerging phenomenon of global cooperation in space missions be seen in Figure \@ref(fig:network-graph). To elaborate, in 1990, the closing of gaps between each node implies that there were some international collaboration through this decade. Following this decade, there was a significant increase in collaboration among countries as indicated by the different coloured nodes being more concentrated in the middle. Furthermore, in the 2000s, other countries embarked on missions without the U.S. and the Russians. Lastly, although we saw a reduced amount of space missions in the last decade, the nodes (Figure \@ref(fig:network-graph)) are more closely tied together and the coloured nodes are scrambled and without a distinct group, signifying more cross-country collaboration. For instance, Russian astronauts are found all around the network.

Over the years, nations saw the potential benefits of approaching space explorations as a mutually beneficial endeavour. For most cases, international collaboration is of paramount importance as they lack the budgetary resources to build new space infrastructures, transport systems and space probes to carry out their space exploration goals. On top of this, some other motivating factors of international cooperation include generating diplomatic prestige, enabling workforce stability and even increasing political sustainability (@broniatowski2006case).


# Conclusions 

From the first humans have accomplished an orbital spaceflight in 1961 (@corlett2020population), to the intensity of launched reached a record figure in 1980s, the astronautical industry has experienced a continuous development. The interesting and enthusiasm of human for universe have prompted the development of astronautical industry. Whether based on the number of projects and missions launched for astronautical exploration, as well as the appearance of female astronauts and more countries join in the space exploration, the astronautical industry has showed the great development to human. 

The astronautical exploration projects and missions experienced a increase trend since the first humans appeared in the universe. And there were a space exploration rush lasted almost 24 years in the world. In that period, the number of project and mission are the highest level from 1961 to today. Meanwhile, many countries also join in the project of the astronautical exploration, which might contribute the development of the space exploration. 

Furthermore, the technologies of the space exploration also have developed. Through the spaceflight activities of space travelers exploration, the overall EVA number steadily increased ten years before, but it decreased in recent years. However, it does not mean the development of the spaceflights is regressing. Since the launch of the ISS program in 1998 (@NASA), the duration of almost each mission task is more than 480 hours.

In addition, female astronauts also appear in the history of astronautical exploration. Although male astronauts are still the main force in the universe, the number of female astronauts trend to increase from 20th century. And the appear of female astronauts might change the history of space exploration and help human with the exploration.


# Acknowledgement

The programming language used to analyse the trends of global astronautical exploration is R (4.0.2) [@R]. And the platform which used for running R language is Rstudio (1.3.1056) [@Rstudio].

Following packages has been included in our Rmd file.

- package tidyverse (1.3.0) [@tidyverse],
- package dplyr (1.0.1) [@dplyr],
- package plotly (4.9.2.1) [@plotly],
- package ggplot2 (3.3.2) [@ggplot2]

# References

