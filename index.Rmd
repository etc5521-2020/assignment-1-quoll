---
title: "ETC5521 Assignment 1"
subtitle: "Global astronautical exploration development"
team: quoll
author:
  - (Jinhao Luo)
  - (Yawen Zhang)
  - Brendi Ang
  - Putu S
date: "`r Sys.Date()`"
output: 
  bookdown::html_document2:
    theme: darkly
    citation_package: biblatex
    toc: true
    number_sections: false
    toc_float:
      collapsed: yes 
bibliography: references.bib
biblio-style: apa
link-citations: yes
---

[This assignment is for ETC5521 Assignment 1 by Team `r rmarkdown::metadata$team` comprising of `r knitr::combine_words(rmarkdown::metadata$author)`.]{style="color:#006DAE;"}

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, cache=FALSE, message=FALSE, warning=FALSE)

library(tidyverse)
library(dplyr)
library(geomnet)
library(plotly)
library(ggplot2)
library(DT)
library(htmltools)
library(patchwork) 
library(png)

# Set theme for graphs
our_theme <- theme(rect = element_rect(fill = "#4e5a65"),
        text = element_text(color = "white", size = 10),
        panel.background = element_rect(fill = "#4e5a65"),
        axis.text = element_text(color = "white"),
        panel.border = element_rect(color = "white", size = 0.8),
        plot.title = element_text(size = 12, face = "bold", colour = "white"),
        plot.subtitle = element_text(size = 15, face = "italic", colour = "white"),
        axis.ticks = element_line(colour = "white")
        )
```

```{css, echo=FALSE}
body {
  text-align: justify}

caption {
  color: white;
}

label {
  color: white;
}

select{
  background-color: #222;
}

.dataTables_wrapper .dataTables_length, .dataTables_wrapper .dataTables_filter, .dataTables_wrapper .dataTables_info, .dataTables_wrapper .dataTables_processing, .dataTables_wrapper .dataTables_paginate {
  color: #ffffff;
}

.dataTables_wrapper .dataTables_paginate .paginate_button.disabled, .dataTables_wrapper .dataTables_paginate .paginate_button.disabled:hover, .dataTables_wrapper .dataTables_paginate .paginate_button.disabled:active {
  color: #fff !important;
}
.dataTables_wrapper .dataTables_paginate .paginate_button {
  color: #ffff !important;
}

.form-control {
  background-color: #2222;
}
```


```{r write-data, eval = FALSE}
tuesdata <- tidytuesdayR::tt_load('2020-07-14')
astronauts_origin <- tuesdata$astronauts

write.csv(astronauts_origin, here::here("data", "astronauts.csv"))
```

```{r read-data}
astronauts <- read_csv(here::here("data", "astronauts.csv"))
```

# Introduction and Motivation

Since Yury Gargarin became the first man in space in 1961, space probes have explored the solar system and have discovered thousands of planets around other stars. For instance, we may not have wireless headphones or even camera phones without these space research and explorations (@green2019). Over the years, many milestones have been achieved around thee world through space travel and exploration. 

From the start, the U.S. and Russian astronauts (cosmonauts) have been the pioneers and forefront of space explorations, leading most of the space expeditions. Unfortunately, the start of space explorations in 1961 begun with an ongoing political rivalry between the U.S. and the Soviet Union (Russia), which developed after World War II; This time frame was more known as the 'Cold War' (@brown2011american).

This report will critically analyse the historical timeline of space explorations and the demographics of astronauts. First, the trends in space missions and astronaut training will be explored by highlights space exploration breakthroughs such as the establishment of the International Space Station and the NASA Space Shuttle Program. Next, international collaboration will be discussed by considering collaborative missions and breaking down the historical timeline into decades to further explore pre and post Cold-War eras Last but not least, the social demographics of astronauts will be studied, with emphasis on the role of female astronauts based on the duration spent in space missions. Further, we will mention female astronauts with exceptional space records that exceeded most male astronauts such as Peggy A. Whitson and Sunita L. Williams. Lastly, the military status and occupations of astronauts will be addressed.

The report can be summarised into one primary question and three secondary question:  
- How has Space Exploration Evolved Through Time?  
  - With the advancements in technological and scientific fields, what are the trends in space missions?  
  - Are there more international Collaboration?  
  - With a large disparity in male and female astronauts, is there a difference in space mission times too?  

# Data Description

The data set used for this analysis encompasses the information of all astronauts who participated in space missions before 15 January 2020. Each row (observation) corresponds to an astronaut's information for a given mission, spanning all the way to the first space mission in 1961 to the 15 January 2020. Some of the variables include:  

The `astronauts` data set, along with its cleaning script are hosted on this [GitHub Link](https://github.com/rfordatascience/tidytuesday/blob/master/data/2020/2020-07-14/readme.md) and is collected from NASA, Roscosmos, and fun-made websites. @tidytuesday The variables used for this analysis are included in the table below:

```{r}
# Pick variables used for analysis
astronauts_var <- astronauts %>% 
  select(-c("X1", "id", "number", "nationwide_number", "original_name", "year_of_birth", "selection", "year_of_selection", "mission_number", "ascend_shuttle", "in_orbit", "descend_shuttle", "field21", "eva_hrs_mission")) %>%
  # Rename variables
  rename(Name = "name",
         Sex = "sex",
         Nationality = "nationality",
         `Miliatry Status` = "military_civilian",
         `Total Number of Missions` = "total_number_of_missions",
         Occupation = "occupation",
         `Year of Mission` = "year_of_mission",
         `Title of Mission` = "mission_title",
         `Mission Duration (hrs)` = "hours_mission",
         `Total mission Duration (hrs)` = "total_hrs_sum",
         `Total EVA Hours` = "total_eva_hrs")

# Retrieve variable class
Variables <- astronauts_var %>% 
  names() 

# Store as a vector
Class <- sapply(astronauts_var, class)

# Variables Description
Description <- c(
            "Full name of Astronaut",
            "Astronaut's Gender",
            "Astronauts' Nationality",
            "Military status",
            "Total number of missions",
            "Occupation",
            "Year of Mission",
            "Mission Title",
            "Duration of Mission (in hrs)",
            "Total Duration of All Missions (in hrs)",
            "Total Duration of All Extravehicular Activities (in hrs)")


tibble(Variables, Class, Description) %>%
  datatable(
    class = 'cell-border stripe',
    rownames = FALSE,
    filter = 'top',
    selection = "multiple",
    escape = FALSE,
    options = list(
      pageLength = 5,
      sDom  = '<"top">lrt<"bottom">ip',
      initComplete = JS(
        "function(settings, json) {",
        "$(this.api().table().header()).css({'background-color': '#4e5a65', 'color': '#fff'});",
        "}"
      )
    ),
    caption = htmltools::tags$caption(
      color = "#ffffff",
      style = 'caption-side: bottom; text-align: center;',
      'Table 1: ',
      em('List of astronauts dataset variables description.')
    )
  ) %>% formatStyle(
    c('Variables', 'Class', 'Description'),
    color = 'white',
    backgroundColor = '#4e5a65'
  )
```


# Analysis and Findings

## Total Space Missions Embarked Over The Years

### Trends in Space Missions

```{r yearly-total-projects, fig.cap = "An overview of the total space missions each year. The x-axis denotes the year of mission and the y-axis shows the total number of missions. It can be observed that there is a steady increase in total space missions till year 2000 before it gradually decreased."}
# Total projects Over the Years
astronauts %>%
  group_by(year_of_mission) %>%
  tally() %>%
  ggplot(aes(x = year_of_mission,
               y = n)) +
  geom_col(fill = "grey",
           colour = "black") +
  geom_smooth(method = "gam",
              color = "#FFD900",
              size = 0.5) +
  scale_x_continuous(breaks = seq(from = 1960, to = 2020, by = 5),
                     labels = seq(from = 1960, to = 2020, by = 5)) +
  labs(x = "Year of Mission",
       y = "Total Number of Missions",
       title = "Total Number of Missions per Year") +
  theme_linedraw() +
  our_theme 
```

Since the solo expedition of Yuri Alekseyevich Gagarin space mission on 12 April 1961 to the Apollo 11 lunar landing in 1969, mankind has grown a stark interest in space exploration (@corlett2020population). In this first mission, his capsule orbited the Earth for approximately 90 minutes before making a safe landing back on the planet; This marked a crucial step for the development of space exploration. 

Based on Figure \@ref(fig:yearly-total-projects), the total number of missions has increased gradually before decreasing at about the year 2000. It can be observed that the total number of missions was at its peak in the year 1985; This period was known as the era of the NASA space shuttle. Over three decades, this space shuttle program hosted a total of 135 flights, where the final shuttle flight, NASA's STS-135 landed on 21 July 2011 (@national2011preparing). It is manifest that the total number of missions dropped dramatically after the discontinuation of the program. 

Not to mention, Figure \@ref(fig:yearly-total-projects) shows a drastic decrease in space missions from 1985 to 1989. This is attributed to the Space Shuttle Challenger disaster, where the U.S. space shuttle broke apart 73 seconds into its flight, killing all seven crew members aboard (@challenger2019). For that reason, the Space Missions in the NASA space shuttle program were halted for two years, which caused the dramatic decline in space missions in 1986 - 1989.


```{r yearly-mission-duration, fig.width = 8, fig.cap = "An overview of the total durations of all space missions for a given year. The x-axis represents the year of mission and the y-axis shows the distribution of the hours spent in each space mission. On an overall level, there is a gradual increase in the duration of space missions."}
# Total Duration (in hours) per Year
astronauts %>%
  ggplot(aes(x = year_of_mission,
           y=total_hrs_sum)) +
  geom_boxplot(aes(group = year_of_mission),
               color = "black",
               fill = "#d3d3d3",
               width = 0.8,
               outlier.color = "cornsilk",
               outlier.alpha = 0.3,
               outlier.size = 0.8
               ) +
  # Add Generalised additive model (GAM)
  geom_smooth(method = "gam",
              color = "#FFD900",
              size = 0.5) +
  labs(x = "Year Of Space Mission",
       y = "Total Duration (in hrs) Spent in Space for a given Year",
       title = "Total Duration of all missions for a Given Year") +
  theme_linedraw() +
  our_theme +
  scale_x_continuous(breaks = seq(from = 1960, to = 2020, by = 5),
                     labels = seq(from = 1960, to = 2020, by = 5))
```

With the developments in the medical, technological, and scientific fields, astronauts are spending more hours in space on average, despite the decrease in the total number of space missions over the years Figure \@ref(fig:yearly-mission-duration). Moreover, the duration of space missions reached unparalleled levels in recent years as compared to the earlier decades.

This has been made possible with advances in space technologies, which have led to the development of increasingly sophisticated space infrastructures, transport systems, and space probes. Naturally, these enhanced space assets and increased human knowledge will provide more avenues for different and greater opportunities for the space frontier. For instance, the first rudimentary International Space Station was launched in 1998 opened up extensive experience, research, and technology and enhanced infrastructure for other envisioned projects in support of human exploration and the development of space (@KrishenKumar2009ECTN). 

### Lead Time Required for Astronaut Training

```{r first-missions, fig.height = 6, fig.cap = "The plot shows the total number of astronauts embarking on their first space mission for a given year. The y-axis shows the total astronauts count and the corresponding x-axis depicts the year of the mission. Contrary to the increase in the total durations in space missions in recent years, new astronauts embarking on space missions were rather stagnant due to an extended training time"}

# Filter to first space flights
astronauts %>%
  filter(total_number_of_missions == 1) %>%
  group_by(year_of_mission) %>%
  tally() %>%
  ggplot(aes(x = year_of_mission,
               y = n)) +
  geom_col(fill = "#d3d3d3",
           colour = "black") +
  geom_smooth(method = "lm",
              color = "#FFD900",
              size = 0.5) +
  scale_x_continuous(breaks = seq(from = 1960, to = 2020, by = 5),
                     labels = seq(from = 1960, to = 2020, by = 5)) +
  labs(x = "Year of Mission",
       y = "Total Astronauts",
       title = "Total Number of Astronauts' First Space Missions") +
  theme_linedraw() +
  our_theme 
```

With the establishment of the International Space Station and a growing array of opportunities in space exploration, one would expect more new astronauts embarking on space missions. However, Figure \@ref(fig:first-missions) illustrates that the amount of new astronauts embarking in space missions does not reflect the progressive increase in space mission durations as observed in Figure \@ref(fig:yearly-mission-duration). This trend highlights the lead time required to train an astronaut through a basic and mission-specific training syllabus. On average, the induction program to be a fully qualified astronaut takes approximately 2 - 4 years, usually contingent on the astronaut's military status (@national2011preparing). Some research even suggested that the time commitment and additional skill sets of astronauts as analogous, despite the difference in the technical nature of training for these professionals (@ball2008surgeons).

### Astronauts Across the Globe

```{r participating-countries, fig.cap = "The Plot shows the number of participating countries for space missions across times. The x-axis represents the year of mission while the y-axis shows the cumulative sum of participating countries. Participating countries surged in late 1970s and have been progressively increasing over the years."}
# * Show map if possible
# Increasing Number of participating countries
astronauts %>%
  # arrange year in ascending order
  arrange(year_of_mission) %>%
  # Find cumulative sum of participating countries
  mutate(cum_unique_entries = cumsum(!duplicated(nationality))) %>%
  ggplot() +
  geom_col(aes(x = year_of_mission, 
               y = cum_unique_entries),
           position = "identity",
           colour = "black",
           fill = "light grey") +
  theme_linedraw() +
  our_theme +
  labs(x = "Year of Mission", 
       y = "Total Participating Countries",
       title = "Increase in Participating Countries over the Years") +
  scale_x_continuous(breaks = seq(from = 1960, to = 2020, by = 5),
                     labels = seq(from = 1960, to = 2020, by = 5))
```


```{r countries-bar-chart, fig.cap = "The plot highlights the proportion of U.S., Russian and other countries' misison counts. The x-axis depicts the year of the mission while the y-axis represents the proportion of mission undertaken by a country. To note, U.S. and Russian astronauts are pioneers and leads the astronautical field"}
astronauts %>%
  mutate(nationality = ifelse(nationality == "U.S." | nationality=="U.S.S.R/Russia", 
                              nationality, 
                              "other")) %>%
  ggplot() + 
  geom_bar(aes(x = year_of_mission, 
               fill = nationality), 
           colour = "black",
           position = "fill",
           alpha = 0.6) + 
  scale_fill_manual(values = c("#52cc00","#92b4f2", "#df9797")) + 
  xlab("Year") + 
  ylab("Proportion of Mission Undertaken") + 
  theme_linedraw() + 
  theme(legend.position = "bottom") +
  our_theme +
  ggtitle("Global Mission Percentage") +
  scale_x_continuous(breaks = seq(from = 1960, to = 2020, by = 5),
                     labels = seq(from = 1960, to = 2020, by = 5))
```

Figure \@ref(fig:countries-bar-chart) demonstrates that the proportion of missions embarked per year was mostly dominated by U.S. astronauts, followed by the Russian cosmonauts. Further, these two countries were the only participating astronauts up till 1977, where Germany, Poland, and Czechoslovakia astronauts ventured on their first space mission. Since then, it can be observed that many other countries joined the world in space exploration (Figure \@ref(fig:participating-countries)). This plot further displays the rise in the astronauts' count from other countries. Nevertheless, the U.S. and the Russians were still the pioneer and had been leading the world in this astronautical field for the last few decades.

```{r country-first-astronaut}
country_first_astronaut <- astronauts %>%
  group_by(nationality) %>%
  summarise(`Year of Country's First Astronaut` = min(year_of_mission)) %>%
  arrange(`Year of Country's First Astronaut`) %>%
  rename(Nationality = nationality)

country_first_astronaut %>%
  datatable(
    class = 'cell-border stripe',
    rownames = FALSE,
    filter = 'top',
    selection = "multiple",
    escape = FALSE,
    options = list(
      pageLength = 5,
      sDom  = '<"top">lrt<"bottom">ip',
      initComplete = JS(
        "function(settings, json) {",
        "$(this.api().table().header()).css({'background-color': '#4e5a65', 'color': '#fff'});",
        "}"
      )
    ),
    caption = htmltools::tags$caption(
      color = "#ffffff",
      style = 'caption-side: bottom; text-align: center;',
      'Table 2: ',
      em('List of country first astronaut')
    )
  ) %>% formatStyle(
    c('Nationality', "Year of Country's First Astronaut"),
    color = 'white',
    backgroundColor = '#4e5a65'
  )
  
```

The table above shows the year in which the country joined the world in space exploration, as mentioned above.


## International Collaboration 

### The Cold War Rivalry (1957 - 1991)

```{r single-country-wrangle, include = FALSE}
single_country_missions <- astronauts %>%
  select(mission_title, nationality, year_of_mission) %>%
  group_by(year_of_mission, mission_title) %>%
  filter(n_distinct(nationality) == 1) %>%
  summarise(total_single_country_missions = n())

# Find total missions per year
total_missions <- astronauts %>%
  group_by(year_of_mission) %>%
  summarise(total_missions = n()) %>%
  ungroup() %>%
  # Join with single country missions data frame
  left_join(single_country_missions, by = "year_of_mission") 

total_missions <- total_missions %>%
  # Convert to numeric to replace NA
  mutate(across(where(is.integer), as.numeric)) %>%
  # Replace NAs with 0
  mutate(total_single_country_missions = if_else(condition = is.na(total_single_country_missions), 
                                                 true = 0,
                                                 false = total_single_country_missions)) %>%
  # Group numeric variables together
  relocate(total_missions, .after = total_single_country_missions) 

# Compute collaborated missions and proportion of single country missions
total_missions <- total_missions %>%
  mutate(total_collab_missions = total_missions - total_single_country_missions) %>%
  relocate(total_collab_missions, .before = total_missions) 

# Make long format for plotting
total_missions_long <- total_missions %>%
  pivot_longer(cols = total_single_country_missions:total_missions,
               names_to = "mission",
               values_to = "total_mission_count")
```

```{r plot-single-countries, fig.cap = "The plot highlights the proportion of single-country space missions to collaborated space missions. The x-axis represents the year of mission while the y-axis illustrates the proportion. It is noticeable that single country missions are depleting over the years."}
total_missions_long %>%
  filter(mission != "total_missions") %>%
  ggplot() +
  geom_col(aes(x = year_of_mission,
               y = total_mission_count,
               fill = mission),
           stat = "identity",
           position = "fill") + 
  labs(x = "Year of Mission",
       y = "Proportion of Single-country Missions",
       title = "Proportion of Single-Country Space Missions Against Collaborate Missions") +
  scale_fill_brewer() +
  theme_bw() +
  theme(legend.position = "bottom") +
  our_theme +
  theme(panel.grid = element_blank()) +
    scale_x_continuous(breaks = seq(from = 1960, to = 2020, by = 5),
                     labels = seq(from = 1960, to = 2020, by = 5)) 
```

The 'Cold War Rivalry' was a term to describe the animosity between the Soviet Union (U.S.S.R) and the United States (US) for the supremacy in spaceflight capability. This bumpy relationship lasted till 1991, often was characterized by periods of mistrust and overt hostility, where early schedules were driven by the cold war 'Space Race', rather than cooperation (@brown2011american).

Figure \@ref(fig:plot-single-countries) indicates this animosity in the relationship; In this cold war period (1957 - 1991), single country space missions were noticeably more during this period. In some 1964 and 1966, all space missions consisted only of single country missions. Over the years, nations recognised how international cooperation has the potential to provide significant benefits to all participants, particularly if managed well. 

### International Collaboration Post Cold-War

```{r sample-wrangling, message = FALSE, include = FALSE}
# Find missions with more than 1 astronaut
missions <- astronauts %>%
  select(mission_title, nationality) %>%
  group_by(mission_title) %>%
  tally() %>% # Total number of astronauts in a mission
  filter(n > 1) %>% # Filter to missions with more than 1 astronaut
  select(-n) # Remove count number

# Select astronauts number& mission title they embarked on 
ast_number <- astronauts %>%
  # Remove row with NA mission title 
  filter(!mission_title == "NA") %>% 
  # Select astronaut number, astronaut name, mission_title
  select(mission_title, number, nationality) 

# Join tables to find astronauts who embarked in mission with more than one astronaut
sample <- left_join(missions, ast_number, by = "mission_title") 
```

```{r sample-combinations, include = FALSE}
# Create data frame with combinations of all astronaut numbers in each mission
## Astronaut number: unique identifier for each astronaut
sample <- sample %>% 
  group_by(mission_title) %>% 
  do(data.frame(t(combn(.$number, 2)))) %>%
  # Rename variables
  rename(number = X1,
         with_number = X2)
```

```{r network-wrangle}
# Select unique astronaut names and relevant variables for analysis
ast_names <- astronauts %>%
  select(mission_title, number, name, sex, nationality, year_of_mission) %>%
  unique()

# Left join to insert names of astronauts into combination
sample_cmbs <- sample %>%
  left_join(ast_names, by = c("mission_title", "number")) %>% # Join by 1st astronaut in a pair
  left_join(ast_names, by = c("mission_title", "with_number" = "number")) %>%
  # rename variables for both astronauts in each pair
  rename(name = name.x, 
         with_name = name.y,
         nationality = nationality.x,
         with_nationality = nationality.y, 
         sex = sex.x,
         with_sex = sex.y,
         year_of_mission = year_of_mission.x) %>%
  select(-year_of_mission.y) # remove same variable

# If astronaut not from US or Russia, categorised as 'Other'
sample_cmbs <- sample_cmbs %>%
  # First astronaut
  mutate(nationality = if_else(condition = nationality %in% c("U.S.S.R/Russia", "U.S."),
                               true = nationality,
                               false = "Other"),
         # Second astronaut
         with_nationality = if_else(condition = with_nationality %in% c("U.S.S.R/Russia", "U.S."),
                               true = nationality,
                               false = "Other"),
         # Categorise mission years into decades
         mission_decade = case_when(
           between(year_of_mission, 1960, 1969) ~ "1960 (Cold-War)",
           between(year_of_mission, 1970, 1979) ~ "1970 (Cold-War)",
           between(year_of_mission, 1980, 1989) ~ "1980s (Cold-War)",
           between(year_of_mission, 1990, 1999) ~ "1990s (Post Cold-War)",
           between(year_of_mission, 2000, 2009) ~ "2000s (Post Cold-War)",
           between(year_of_mission, 2010, 2019) ~ "2010s (Post Cold-War)"
         )
         )
```

```{r network-graph, echo = FALSE, message = FALSE, fig.cap = "This network graphs illustrates the international collaboration through a time line broken down into pre and post Cold War Rivalry. Nodes are split into 3 colours to denote astronauts from U.S., Russian and other countries. International collaboration are signified by closer nodes and less distinct colour groups. It can be observed that international collaaboration increased exponentially since the first space mission."}
set.seed(10001) 

sample_cmbs %>%
  ggplot() +
  geom_net(aes(from_id = name,
               to_id = with_name,
               colour = nationality,
               group = mission_title),
           layout.alg = "fruchtermanreingold",
           alpha = 0.05,
           labelon = FALSE,
           size = 1.5, # increase size of dot points
           linewidth = 0.2,
           ecolour = "grey60", # Change edge colour
           ealpha = 0.5) +
  scale_colour_manual(values = c("#b7ff49", "#92b4f2", "#df9797")) +
  facet_wrap(~ mission_decade,
             ncol = 3) +
  labs(color = "Austronaut's Nationality",
       # Change legend title
       title = "International Collaboration of Astronauts in Space Missions Across the Decades",
       subtitle = "In Space Missions with 2 or more Astronauts") + 
  theme_net() +
  theme(legend.position = "bottom", 
        legend.direction = "horizontal", # Adjust legend layout
        legend.title = element_text(color = "white", size = 10), # Change size of text in legend title
        legend.text = element_text(color = "white", size = 10), # Change size of text in legend title
        legend.background = element_rect(fill = "#3d3d3d"), # change legend background
        legend.key.size = unit(1, "cm"), # Adjust size of legend
        plot.background = element_rect(fill = "#4e5a65"), # grey background for plot
        plot.title = element_text(size = 20, face = "bold", colour = "white"), # Adjust title
        plot.subtitle = element_text(size = 15, face = "italic", colour = "white"), # Adjust subtitle
        strip.text.x = element_text(size = 12, colour = "white"), # Change facet labels
        strip.background = element_rect(fill="#474747") # Change facet background 
  ) +
  guides(color = guide_legend(override.aes = list(size = 5))) # Adjust size of shape in legend key
```

In this Figure \@ref(fig:network-graph), we have split the time frames into distinct time frames characterised by a decade. The "Cold War Period" is represented in the first row of the top panel, spanning all the way from 1960 - 1990. Correspondingly, the next row represents the "Post Cold-War) time frame.

### Cold-War Period

In 1960 - 1980, there are noticeably fewer space missions as it was the beginning of the space exploration era. However, the animosity between the U.S. and Soviet Union astronauts is manifest in these decades as there was no collaboration, and the U.S and Russian astronauts worked exclusively with one another. 

As mentioned in the previous sections, the late 1970s marked the emergence of astronauts of other nationalities (besides U.S. and Russian). Based on Figure \@ref(fig:network-graph), it can be observed that these new countries only went on space missions exclusively with the U.S. and the Russians but not within their countries. It can be implied that they were fairly new to space exploration. Furthermore, we see a significant increase in space missions in this decade, which may be attributed to the establishment of the NASA space shuttle program as mentioned in Figure \@ref(fig:yearly-total-projects).

### Post Cold-War: Stepping Stones towards Global Space Exploration 

From 1990 to 2019, international collaboration increased exponentially, with 35 new international partnerships over this period of time (@national2011preparing). Furthermore, the late 1990s marked the launch of the International Space Station. 

These emerging phenomenon of global cooperation in space missions be seen in Figure \@ref(fig:network-graph). To elaborate, in 1990, the closing of gaps between each node implies that there were some international collaboration through this decade. Following this decade, there was a significant increase in collaboration among countries as indicated by the different coloured nodes being more concentrated in the middle. Furthermore, in the 2000s, other countries embarked on missions without the U.S. and the Russians. Lastly, although we saw a reduced amount of space missions in the last decade, the nodes (Figure \@ref(fig:network-graph)) are more closely tied together and the coloured nodes are scrambled and without a distinct group, signifying more cross-country collaboration. For instance, Russian astronauts are found all around the network.

Over the years, nations saw the potential benefits of approaching space explorations as a mutually beneficial endeavour. For most cases, international collaboration is of paramount importance as they lack the budgetary resources to build new space infrastructures, transport systems and space probes to carry out their space exploration goals. On top of this, some other motivating factors of international cooperation include generating diplomatic prestige, enabling workforce stability and even increasing political sustainability (@broniatowski2006case).

## Women performance in astronautical exploration

According to figure \@ref(fig:gender), while women have also appeared in space exploration, men have been the main force in this 49-year period. However, we cannot ignore the contribution of female astronaut in space exploration. @jacksona2019women indicated that women has preformed essential work in astronautical area since 19th century. Furthermore, @jacksona2019women also illustrated that the first women travelled into space was in 1963, and the first American female astronaut appeared in 1983. Female astronauts also contribute to the exploration same as male astronauts. 

```{r gender, fig.cap="Astronaut gender amount comparison"}
gender <- astronauts %>%
  select(year_of_mission,sex) %>% 
  group_by(year_of_mission) %>% 
  count(sex) 


gender %>% 
  ggplot() + 
  geom_bar(aes(sex, fill = sex)) + 
  scale_fill_manual(values=c("#f292e5","#9294f2"))+
  xlab("gender") + 
  ggtitle("Astronaut Gender Amount") +
  theme_linedraw()+
  our_theme
```

Female astronauts trend to increase in the space exploration. According to figure \@ref(fig:gender-percentage), although there was female astronauts appears in the space in 1963, there was a 20-year empty period for female astronauts until 1981. Such situation finished until 1982, and after that, female astronauts trend to increase in fluctuation along with year growing. And female astronauts have appeared in the astronautical exploration almost every year. 

```{r gender-percentage, fig.cap="Global gender share in astronautical exploration of each year "}
astronauts %>% 
  select(year_of_mission, sex) %>% 
  ggplot() + 
  geom_bar(aes(x = year_of_mission, fill = sex), position = "fill") + 
  scale_fill_manual(values=c("#f292e5","#9294f2"))+
  xlab("year") + 
  ggtitle("Global Gender Share") +
  theme_linedraw()+
  our_theme
``` 

Overall, female astronauts have started to appear frequently in the space exploration, and experienced a general increase tendency. However, female astronauts are still account for a low share compared with male astronauts. While, @jacksona2019women explained that the possibilities and need for more females in astronautical exploration have been considered in the worldwide nowadays. Female astronauts would trend to contribute more in the space exploration in the future, and more and more female might appear in the universe.

### Is there any female astronauts that have longer mission duration than men?

According to the \@ref(fig:gender) figure, we would like to explore more deeply the role of female astronauts in space missions. First of all, let us see how the female and male astronauts compare in total mission hour and extravehicular activity in space. If we look at Figure \@ref(fig:mission-hour-male-vs-female), two graphs show the comparison between the two. In general, female astronauts have less time than men, both on missions and extravehicular activity. The total number of days for men in (A) reaches almost 150,000 days while for women around 12,500 days. The same thing also happened to extravehicular activities (B) where the total days of women did not reach 100 days, but men were more than 500 days.

```{r mission-hour-male-vs-female, fig.cap="These two charts show the ratio of male and female astronauts in mission duration in days. The X-axis shows gender, while the y-axis shows the number of days. (A) By mission days, female have much lower duration than male, (B) In the total extravehicular activity, male have much longer to do the activity than female.", out.height="50%"}

mission_hrs <- astronauts %>%
  #create new column day of mission
  mutate(day_of_mission = total_hrs_sum / 24) %>%
  # plot the data
  ggplot(aes(x = sex, y = day_of_mission, fill = sex)) +
  geom_col() +
  scale_fill_manual(values=c("#f292e5","#9294f2"))+
  xlab("") +
  theme_linedraw() +
  # assign our theme
  our_theme +
  # add tag 
  labs(tag = "(A)", y = "Total Mission Length (in day)", color = "Sex")

eva_hrs <- astronauts %>%
   #create new column day of mission
  mutate(day_of_mission = total_eva_hrs / 24) %>%
  # plot the data
  ggplot(aes(x = sex, y = day_of_mission, fill = sex)) +
  geom_col() +
  scale_fill_manual(values=c("#f292e5","#9294f2"))+
  xlab("") +
  theme_linedraw() +
  # assign our theme
  our_theme +
  # add tag
  labs(tag = "(B)", y = "Total Extravehicular Activity (in day) ", color = "Sex")

# combine the image together side by side with the tags
mission_hrs + eva_hrs + plot_layout(guides = "collect")
```

Next, we want to map each astronaut who has undergone a space mission based on mission duration, gender, and nationality. Figure \@ref(fig:astro-plotly) is an interactive plot that can be changed based on nationality. The x-axis shows the mission duration and the y-axis shows the name. Each point in this scatter plot represents one astronaut's name.


```{r astro-plotly, fig.cap="The interactive scatter plot with filter by nationality, x-axis shows mission duration in hours and y-axis represents name of the astronauts. Hover the point to look at the details of evry astronauts."}
# create the button attributes with restyle method from plotly
button_list <-
  lapply(1:length(unique(astronauts$nationality)), function(x) {
    list(
      method = "restyle",
      args = list(paste0("transforms[0].value"), unique(astronauts$nationality)[x]),
      label = unique(astronauts$nationality)[x]
    )
  })

# assign the model and layout of the button, here we used dropdown.
type_list <-  list(
  type = 'dropdown',
  active = -1,
  xanchor = 'right',
  yanchor = "top",
  pad = list('r' = 0, 't' = 10, 'b' = 10),
  x = 1.2,
  y = 1.2,
  buttons = button_list, # assign button_list object to buttons
  font=list(color = '#ffffff'),
  activecolor = list(color="fff000")
)

# the theme of y axis
axy <- list(
  title = "Name",
  zeroline = FALSE,
  showline = TRUE,
  showticklabels = FALSE,
  showgrid = FALSE,
  color = '#ffffff'
)
# the theme of x axis
axx <- list(
  title = "Total Mission in Hours",
  zeroline = FALSE,
  showline = TRUE,
  showticklabels = TRUE,
  showgrid = FALSE,
  color = '#ffffff'
)

# make scatter plot using plotly
plot_ly(
  astronauts,
  x = ~total_hrs_sum,
  y = ~name,
  # assign nationality column as object named customdata
  customdata=~nationality,
  type = "scatter",
  mode = "markers",
  # the point will be colored based on the sex
  color = ~sex,
  # assign color palletes
  colors = c("#f292e5", "#9294f2"),
  # assign the info when hovering the point
   text = ~ paste('</br> Name: ',name,
                  '</br> Nationality: ',nationality,
                  '</br> Total Hours: ',total_hrs_sum),
   hoverinfo = "text",
  # assign the filter and the target
  transforms = list(
    list(
      type = 'filter',
      target = 'customdata',
      operation = '=',
      value = astronauts$nationality
    )
  )
) %>%
  # modify layout of the plot
  layout(updatemenus = list(type_list),
         paper_bgcolor="#4e5a65",
         plot_bgcolor ="#4e5a65",
         xaxis = axx,
         yaxis = axy,
         title = "Every Single Astronaut's Time",
         titlefont = list(color = '#ffffff'),
         legend = list(font=list(color = '#ffffff')))%>%
  # hide the plotly ModeBar 
   config(displayModeBar = FALSE)

```


```{r female-mission}
# data for male vs male in mission duration
plot_mission <- astronauts %>%
  # group the data by name and summarised them by sex, nationality, and total hours
  group_by(name) %>%
  summarize(sex = sex,
            nationality = nationality,
            total_hrs_sum = total_hrs_sum) %>%
  unique() %>%
  # arrange from highest to lowest based on total hours
  arrange(desc(total_hrs_sum)) %>%
  # create the new variable day of mission by divide total hour with 24
  mutate(day_of_mission = total_hrs_sum / 24) %>%
  # only take 15 highest data
  head(15) %>%
  # plot the data
  ggplot(aes(
    x = fct_reorder(name, total_hrs_sum),
    y = day_of_mission,
    color = sex
  )) +
  geom_point(size = 2) +
  geom_segment(aes(
    x = name,
    xend = name,
    y = 0,
    yend = day_of_mission
  ), size = 1.2) +
  scale_color_manual(values=c("#f292e5","#9294f2"))+
  theme_linedraw() +
  ggtitle("Space Mission")+
  our_theme +
  theme(legend.key = element_rect(fill = "#4e5a65")) +
  theme(plot.title.position = "plot") +
  ylab("Mission in days") +
  labs(tag = "(A)") +
  coord_flip()
```

```{r female-eva-mission}
# data for male vs male in eva duration
plot_eva <- astronauts %>%
  # group the data by name and summarised them by sex, nationality, and total hours
  group_by(name) %>%
  summarize(sex = sex,
            nationality = nationality,
            total_eva_hrs = total_eva_hrs) %>%
  unique() %>%
  # arrange from highest to lowest based on total hours
  arrange(desc(total_eva_hrs)) %>%
    # create the new variable day of mission by divide total hour with 24
  mutate(day_of_mission = total_eva_hrs / 24) %>%
    # only take 15 highest data
  head(15) %>%
  # plot the data
  ggplot(aes(
    x = fct_reorder(name, day_of_mission),
    y = day_of_mission,
    color = sex
  )) +
  geom_point(size = 2) +
  geom_segment(aes(
    x = name,
    xend = name,
    y = 0,
    yend = day_of_mission
  ), size = 1.2) +
  theme_linedraw() +
  scale_color_manual(values=c("#f292e5","#9294f2"))+
  ggtitle("Eva Activity")+
  our_theme +
  theme(legend.key = element_rect(fill = "#4e5a65"))+
  theme(plot.title.position = "plot")+
  ylab("Mission in days")+
  labs(tag = "(B)")+
  coord_flip()
```

From the interactive plot above, at a glance, we can see that there is a female astronaut who has a high enough mission time. Therefore, we will next present the 15 astronauts with the highest mission duration and spacewalk. In Figure \@ref(fig:astro-15) there are two plots A and B. Plot A shows the space mission while plot B shows extravehicular activity among astronauts. In Plot A, there is one female astronaut who is in ninth place, namely Peggy A. Whitson. Peggy has gone on space expeditions for a total of 665 days. Also, in plot B, we can see that Peggy is in fourth place in the spacewalk mission with a total time of 2.5 days. Another woman Astonot is Sunita L. Williams who is in tenth place. Sunita set out on a mission in 2006 and 2012 with a total extravehicular activity time of 2 days.

```{r astro-15, fig.cap="The lollipop graph that shows fifteen top astronauts based on mission times and extravehicular activity. (A) Whitson Peggy is the only female astronauts that sit on big nine in longest mission time, (B) Whitson Peggy and William SUnita are the only female astronauts that have more extravehicular activity in top fifteen", out.width="100%", out.height="60%"}
# combined the plots side by side
plot_mission + plot_eva + plot_layout(guides = "collect", heights = 100)
```

Peggy A. Whitson and Sunita L. Williams in Figure \@ref(fig:whitson-sunita), are American astronauts. Reported from @mars_peggy_2015, "Peggy completed two six-month tours of duty aboard the station for Expedition 5 in 2002, and as the station commander for Expedition 16 in 2008 where she accumulated 377 days in space between the two missions, the most for any US. woman at the time of her return to Earth." Another interesting fact from Peggy is that stated in @potter_record-setting_2018, in 2008, Whitson returned on Expedition 16 and became the first female commander of the space station. @potter_record-setting_2018 report that Peggy announced her retirement on June 16, 2018. 

@whiting_sunita_2016 explained that Sunita L Williams is a female astronaut selected by NASA in 1998 who has carried out two space missions Expeditions 14/15 and 32/33. Reported by @whiting_sunita_2016, now she is preparing for her third long-duration mission aboard the International Space Station. 

```{r whitson-sunita, fig.align='center', fig.cap=' **Left** : Peggy A. Whitson (Ph.D.), the U.S. record holder, placing eighth on the all-time space endurance list. **Right** : Sunita L. Williams, a veteran of two space missions Expeditions 14/15 and 32/33 (source:NASA)'}
 img <- readPNG("data/whitson-sunita.png")
 grid::grid.raster(img)
```

Apart from Peggy and Sunita, there are many female astronauts from various countries who have carried out space missions. The rest can be seen in Table 3 below.

```{r}
# a custom table container
sketch = htmltools::withTags(table(
  class = 'display',
  thead(
    tr(
      th(colspan = 2, 'Profile'),
      th(colspan = 4, 'Mission Time'),
    ),
    tr(
      lapply(rep(c('Name','Sex','Nationality','Mission', 'Extravehicular'), 1), th)
    )
  )
))

astronauts %>%
  filter(sex == "female") %>%
  # group the data by name and summarised them by sex, nationality, and total hours
  group_by(name) %>%
  summarize(
    sex = sex,
    nationality = nationality,
    total_hrs_sum = total_hrs_sum,
    total_eva_hrs = total_eva_hrs
  ) %>%
  unique() %>%
  # arrange from highest to lowest based on total hours
  arrange(desc(total_hrs_sum)) %>%
  datatable(
    class = 'cell-border stripe',
    container = sketch,
    rownames = FALSE,
    filter = 'top',
    selection = "multiple",
    escape = FALSE,
    options = list(
      pageLength = 5,
      sDom  = '<"top">lrt<"bottom">ip',
      initComplete = JS(
        "function(settings, json) {",
        "$(this.api().table().header()).css({'background-color': '#4e5a65', 'color': '#fff'});",
        "}"
      )
    ),
    caption = htmltools::tags$caption(style = 'caption-side: bottom; text-align: center;', 'Table 3: ',
                                      em('List of Female Astronauts.'))
  ) %>%
  formatStyle(
    c('name', 'sex', 'nationality', 'total_hrs_sum', 'total_eva_hrs'),
    color = 'white',
    backgroundColor = '#4e5a65'
  )
```

We want to see the background of the female astronaut in the dataset. In Figure \@ref(fig:figures-side) two graphs show a summary of the background of the female astronaut. In figure (A), astronauts with a civilian background dominate the military. A total of 106 came from civilian and 37 from the military.
Furthermore, in figure (B), 106 people who come from civilian are MSP (Mission Specialist). Based on @nasa_selection , Mission Specialists are working closely with the commander and pilot, are responsible for coordinating onboard operations involving crew activity planning.  Furthermore, 20 people were flight engineers, 7 were pilots, 3 were flight commander, and 5 were PSP (Payload Specialist). @nasa_selection stated that Payload Specialist is a professional in the physical or life sciences or a technician skilled in operating Shuttle-unique equipment. What is interesting about this plot is that there are two people who are Space Tourist.

They are Anousheh Ansari, an American businesswoman and Lee So Yeon from South Korea. Reported in @nasa_expedition, "American businesswoman Anousheh Ansari will fly with the Expedition 14 crew to the International Space Station as a spaceflight participant." @nasa_expedition explained that she spent nine days on the station under a commercial agreement with the Russian Federal Space Agency (Roscosmos) and returned to Earth with the Expedition 13 crew. In that expedition, she was with Sunita Williams on board.

Meanwhile based on @nasa_2012_international, Lee So Yeon is the first South Korean female astronaut to fly into space. Reported by NASA, she was selected from among 36,000 applicants to serve as her nation's first astronaut. @nasa_2012_international stated that she flew on Soyuz TMA-12 to the International Space Station (ISS) on April 8, 2008, returning to Earth 10 days later. 



```{r figures-side, fig.cap="The bar graph shows female astronauts background, (A) More astronauts comes from civilian than military fields, (B) MSP is a dominant occupation and there are small number of Space Tourist", fig.show="hold", out.width="50%"}
astronauts %>%
  filter(sex=="female") %>%
  group_by(sex, military_civilian) %>%
  tally() %>%
  ggplot(aes(x = military_civilian, y = n, fill = sex)) +
  geom_col()  + 
  scale_fill_manual(values=c("#f292e5"))+
  theme_linedraw()+
  our_theme+
  theme(legend.position = "none")+
  ylab("")+
  xlab("")+
  labs(tag = "(A)", title = "Military Civilian Background")

astronauts$occupation[astronauts$occupation == "Other (space tourist)"] <-
  "Space Tourist"
astronauts$occupation[astronauts$occupation == "Space tourist"] <-
  "Space Tourist"
astronauts$occupation[astronauts$occupation == "Other (Space tourist)"] <-
  "Space Tourist"
astronauts$occupation <- tools::toTitleCase(astronauts$occupation)

astronauts %>%
  filter(sex=="female") %>%
  group_by(sex, occupation) %>%
  tally() %>%
  ggplot(aes(x = fct_reorder(occupation,n), y = n, fill = sex)) +
  geom_col()+
  scale_fill_manual(values=c("#f292e5"))+
  theme_linedraw() +
  our_theme+
  ylab("")+
  xlab("")+
  labs(tags="(B)", title = "Occupation Background")
```


# Conclusion 

Since the first space mission, many milestones have been met through space travel and exploration. Although space missions have decreased over the year is associated with the increased in total duration spent. This was due to advancements in medical, technological, and scientific fields which allowed astronauts to stay longer in space with minimal health implications.

Initially, space exploration has been sparked by the Cold War Rivalry between the U.S. and Russian astronauts, the pioneers and leaders of space exploration. Over the years, nations started to realise the potential benefits of approaching space explorations as a mutually beneficial endeavour such as significant cost reduction. Through astronautical breakthroughs such as the international space station, international collaboration has improved at unprecedented rates.

Besides, female astronauts also appear in the history of astronautical exploration. Although male astronauts dominate the number of astronauts who go on missions to space, actually some female astronauts have longer mission time than men. Whitson A. Peggy and Williams Sunita are the veteran female astronauts who are among the top fifteen astronauts who have the most extended mission and extravehicular activity over the year. Another fact that emerges is that more female astronauts come from civilians than from the military.


# Acknowledgement

The programming language used to analyse the trends of global astronautical exploration is R (4.0.2) [@R]. And the platform which used for running R language is Rstudio (1.3.1056) [@Rstudio].

Following packages has been included in our Rmd file.

- package tidyverse (1.3.0) [@tidyverse],
- package dplyr (1.0.1) [@dplyr],
- package plotly (4.9.2.1) [@plotly],
- package ggplot2 (3.3.2) [@ggplot2]
- package geomnet (0.3.0) [@geomnet]
- package DT (0.15) [@DT]
- package htmltools (0.5.0) [@htmltools]
- package patchwork (1.0.1) [@patchwork]
- package png (0.1-7) [@png]

# References


