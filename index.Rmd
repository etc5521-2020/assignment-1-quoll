---
title: "ETC5521 Assignment 1"
subtitle: "Global astronautical exploration development"
team: quoll
author:
  - Jinhao Luo
  - Yawen Zhang
date: "`r Sys.Date()`"
bibliography: references.bib
biblio-style: apa
output: 
  bookdown::html_document2:
    citation_package: biblatex
    toc: true
---

[This assignment is for ETC5521 Assignment 1 by Team `r rmarkdown::metadata$team` comprising of `r knitr::combine_words(rmarkdown::metadata$author)`.]{style="color:#006DAE;"}

```{r setup, include = FALSE}
knitr::opts_chunk$set(echo = FALSE, cache=FALSE, message=FALSE, warning=FALSE)

library(tidyverse)
library(dplyr)
library(plotly)
library(ggplot2)
```

```{r write-data, eval = FALSE}
tuesdata <- tidytuesdayR::tt_load('2020-07-14')
astronauts_origin <- tuesdata$astronauts

write.csv(astronauts_origin, here::here("data", "astronauts.csv"))
```

```{r read-data}
astronauts <- read.csv(here::here("data", "astronauts.csv"))

our_theme <- theme(rect = element_rect(fill = "#4e5a65"),
        text = element_text(color = "white", size = 10),
        panel.background = element_rect(fill = "#4e5a65"),
        axis.text = element_text(color = "white"),
        panel.border = element_rect(color = "white", size = 0.8),
        plot.title = element_text(size = 12, face = "bold", colour = "white"),
        plot.subtitle = element_text(size = 15, face = "italic", colour = "white"),
        axis.ticks = element_line(colour = "white")
        )
```

# Introduction and motivation

@corlett2020population indicated that since the first humans completed an orbital spaceflight in 1961 and stepped on the moon in 1969, space missions have been completed nearly 60 years. Meanwhile, space exploration is still technologically challenging and competitive. Therefore, this report would try to analyses the development of the world astronautic exploration from 1961. In the following sections, we will describe the data set and source of the data, and what is the data prepared for. The data description also includes how we transform and clean the raw data for analysis. Beside, our statistical programming used for analysis is R and Rstudio. However, the data set might be not comprehensive, which might result in insufficient analysis and conclusion. Meanwhile, some missing values also included in the data, which might impact on the accuracy of the report. Such limitation should be considered and improved in following analysis.

Based on the purpose of finding the development of astronautical exploration, this report would consider a primary question and three secondary questions. The primary question will focus on the development of the world astronautic exploration with time from the first spaceflight launched. In addition, the three secondary questions should be: Firstly, What has been the trend in astronautic exploration over the last eight-five years? Secondly, How is the technology of astronautic exploration development? Thirdly, Do females also contribute to astronautic exploration? What's the trend of female astronauts? Those questions would be explored in following part. 


# Data description

The data which are used for analysing in this report are from the astronaut database. Because only one website could not contain comprehensive and up-to-date astronautic information. Therefore, this database was collected from NASA, Roscosmos, and fun-made websites, which includes information about the space mission before 15 January 2020. Furthermore, this data contains 24 different types of information about 1277 astronauts which are name, sex, year of birth, nationality, military status, the name and year of selection program, information about each mission implemented by astronaut such as year, title, ascend and decent shuttle names, duration of mission and extravehicular activity (EVAs). The version of data has been updated on 14 July 2020, which contains the astronautic information from 1961 to 2019. The data used in this report was read from the TidyTuesdayR package, and it has been saved in a new csv file called astronaut for later use.

By browsing the whole dataset and using the glimpse function to observe the variables and the corresponding classes by R, this report decides to apply this dataset into analysing the development of the astronautic industry. Meanwhile, according to the observation, the report would try to use several important and useful variables to explore the development of the astronautic industry as much as possible, like the year, number, and duration of missions, proportion of space travelers, the number of extravehicular activity and the gender of astronauts. In addition, some missing values and inappropriate classes of variables have been found, which would be considered in the following analysing part.

# Analysis and findings

The first human orbital spaceflight has completed 59 years ago. To explore and identify the development of global astronautical exploration, the report would consider the changes of the astronautical exploration projects and missions since the 1961. Meanwhile, the number of country that join the exploration would also be considered to identify the development of the astronautical exploration. Furthermore, the enthusiasm of human for exploring the space could be reflected on the tech of astronautic exploration development. Last but not least, the trends of gender of astronauts would be used for consider the development situation. The following sections will focus on three secondary questions to explore and support the development situation of global astronautical exploration. 

## Trends in the astronautical exploration

@corlett2020population have indicated that humans have never stop their steps of space exploration. Since 1961 the first humans have accomplished an orbital spaceflight, many countries join the team of exploring the space. Therefore, identify the trend in astronautical exploration projects could help the readers realise the development of the space exploration. According to figure \@ref(fig:yearly-total-projects), the general trend of global space exploration projects is increase from 1961 to 1985. In 1985, the number of global project has reached the peak which 28 projects has been launched in this single year. After that the global project has experienced a significant decrease trend. Although the number of project has bounced to 14 in 1992, and fluctuated in the following seventeen years, the general trend of project amount is decrease after 1985. In general, based on figure \@ref(fig:yearly-total-projects) which might indicates that the global astronautical exploration competition between each government is fierce, and the competition has reached the peak in 1985. Although the amount has decreased after peak. The competition, however, still remained strong until 2009.

```{r yearly-total-projects, fig.cap= "Yearly astronauticalal exploration project amount in the world"}
projects <- astronauts %>% 
  select(year_of_mission, 
         mission_title) %>%
  group_by(mission_title) %>%
  unique() %>%
  ungroup() 


yearly_projects <- projects %>% 
  mutate(mission_title = as_factor(mission_title)) %>% 
  group_by(year_of_mission) %>% 
  summarise(total = length(mission_title)) %>%
  ungroup()

projects_plot <- yearly_projects %>%
  ggplot(aes(year_of_mission, total)) +
  geom_point() +
  geom_line() + 
  xlab("Year") +
  ylab("Total") +
  ggtitle("Global Yearly Project Amount")

ggplotly(projects_plot)
```


Beside the number of projects, the mission amount which needed to be carried out by each shuttle launched could also be used for identifying the trends of astronautical exploration, because each mission in a project is for helping human to explore the universe. According to figure \@ref(fig:yearly-mission), it seems likely that there are four times of astronautical exploration rush in human history. In those period, humans set many missions to help the space exploration. The first rush happened in 1985. There were over 60 missions has been carried out in the space , and it was the peak for astronautical exploration. Human has started to show their enthusiasm for astronautical exploring. The duration and amount of mission has remained in a high level in the following thirty-year. Four years later after 1985, the second rush appeared and lasted thirteen years. In that period, average 40 missions has been carried out in universe per year. The third and forth peak also happened in the following years, which lasted three and two years, respectively. Although, the amount of missions decreased after 2009, the mission amount still remained in above 10 cases level per year until now. Overall, human never stop their steps to explore the space. astronautical exploration has experienced a increase trend from 1961 and remained in a high level for many years.

```{r yearly-mission, fig.cap= "Yearly astronautical exploration mission amount in the world (total mission in yearly projects)"}
yearly_mission <- astronauts %>% 
  group_by(year_of_mission) %>% 
  summarise(total_mission = length(total_number_of_missions))

yearly_mission %>% 
  ggplot(aes(year_of_mission, total_mission)) +
  geom_col(fill = "#6cc5eb") + 
  geom_line(lwd = 1, colour = "red") +
  geom_text(aes(label=year_of_mission, angle = 90), size = 3, hjust = -0.1, vjust = 0.3, position = "stack") + 
  ylim(0,70) + 
  xlab("Year") + 
  ylab("Total") + 
  ggtitle("Global Yearly Mission Amount")
```

In addition, an astronautical exploration race has launched along with the human desire for space. Figure \@ref(fig:countries-line-chart) and figure \@ref(fig:countries-bar-chart) indicate the astronautical mission amount trends of each country and global astronautical mission share of each country, respectively. According to figure \@ref(fig:countries-line-chart), the main forces of space exploration were United State and U.S.S.R, which were in the same level before 1981. After that, however, U.S. increased the mission amount significantly, and lead the world level over thirty-two years. On the other hand, based on figure \@ref(fig:countries-bar-chart), U.S. and U.S.S.R/Russia seem play an important role in astronautical exploration in the world. But U.S was still the leader in the astronautical field, and it has occupied the most astronautical exploration missions in the world. @blamont2005international explained that the awareness of universe, and technical advantage have contributed the leader level to United State. However, even though U.S. and U.S.S.R dominated the astronautical field from 1961 and 1977, there were some new countries join that field in 1978 based on figure \@ref(fig:countries-bar-chart). And after that the trend of new countries joining the universe exploration is increasing in general. In conclusion, although the technical advantages has increased the gaps of each country, and contributed the leader level to United State, many countries still join the astronautical exploration. And more and more countries would join in the exploration, which might become the trend.

```{r countries-line-chart, fig.cap="Yearly mission amount of each countries"}
countries <- astronauts %>%
  group_by(year_of_mission,nationality) %>% 
  summarise(total_mission = length(nationality)) %>%
  ungroup() %>% 
  mutate(nationality = ifelse(total_mission <4, "other", nationality))

countries_plot <- countries %>%
  ggplot(aes(year_of_mission, total_mission)) +
  geom_line(aes(colour = nationality)) + 
  labs(colour = "country") + 
  xlab("Year") + 
  ylab("Count") + 
  ggtitle("Country Mission Amount")

ggplotly(countries_plot)
```

```{r countries-bar-chart, fig.cap="The global percentage of each country's mission"}
countries_two <- astronauts %>%
  select(nationality, year_of_mission) %>%
  mutate(nationality = ifelse(nationality == "U.S." | nationality=="U.S.S.R/Russia", nationality, "other"))

countries_two %>% 
  ggplot() + 
  geom_bar(aes(x = year_of_mission, fill = nationality), position = "fill") + 
  scale_fill_manual(values = c("#eb3434", "#34bdeb", "#e2eb34")) + 
  xlab("Year") + 
  ylab("Count") + 
  theme_classic() + 
  guides(fill = guide_legend(title = "country")) + 
  ggtitle("Global Mission Percentage")
```

## The tech of astronautic exploration development

### Number of extravehicular (EVA) operations per year

This Figure \@ref(fig:plotEVA) describe the Number of extravehicular (EVA) operations per year. Add up all the EVA in the same year and make this bar chart. Since the first spacewalk performed by Alexei Leonov in 1965, the number of extravehicular activity (EVA) was performed steadily increased especially around year 2000 over than 300 times per year. After year 2000, the number of times of EVA has decreased, it does not mean that the development of spaceflights is regressive. Figure \@ref(fig:plotmissionhours) shows the execution duration for each mission and the results is dramatically increased.  

```{r select-raw-data}
EVA_number_year <- astronauts %>%
  select(year_of_mission, eva_hrs_mission) %>%
  #arrange(year_of_mission)
  group_by(year_of_mission) %>%
  summarise(sum(eva_hrs_mission)) %>%
  rename(Total = `sum(eva_hrs_mission)`, Year = year_of_mission)
```

```{r plotEVA, fig.cap="Number of EVA operation per year"}
EVA_number_year %>%
  ggplot(aes(x = Year, y = Total)) +
  geom_bar(stat="identity") +
  theme(panel.grid.major =element_blank(), panel.grid.minor = element_blank(), panel.background = element_blank(),axis.line = element_line(colour = "black")) +
  ylab("Number of EVA") +
  ggtitle("Number of Extravehicular (EVA) Operations per Year")
```


### Proportion of Space Travelers in Different Spaceflights

Based on the article written by Corlett,  Stavnichuk and Komarova in 2020, divided the duration of mission hours into three categories could observe the progress of space traveler more intuitively. These three categories include participant short spaceflights less than 96 hours, intermediate spaceflights between 96 to 480 hours and long spaceflights more than 480 hours. When the spaceflights first developed, all the duration of mission is less than 96 hours. After that the time astronauts spent in space increased through the spaceflights histories. The recent trend is the time spent on each mission exceeds 480 hours which shows in Figure \@ref(fig:plotmissionhours). @NASA explained the potential reason related to the launch of the International Space Station (ISS) program in 1998. 

```{r total-astronausts}
total_astronauts <- astronauts %>%
  select(name, year_of_mission, hours_mission) %>%
  arrange(year_of_mission) %>%
  count(year_of_mission)
```  
  
```{r mission-less-96h}  
astronauts_96 <- astronauts %>%
  select(year_of_mission, hours_mission) %>%
  filter(hours_mission < 96 ) %>%
  count(year_of_mission)
```

```{r join-96-total}
join_96 <- full_join(astronauts_96,total_astronauts,  by = "year_of_mission") %>%
  arrange(year_of_mission)

join_96[is.na(join_96)] <- 0
prop_96 <- join_96 %>%
  rename("number96" = n.x, total = n.y) %>%
  mutate(proportion_96 = (number96 / total)) %>%
  select(year_of_mission, proportion_96)
```


```{r mission-between-96-480h}
astronauts_96_480<- astronauts %>%
  select(year_of_mission, hours_mission) %>%
  # mutate(total = sum(year_of_mission)) %>%
  filter(hours_mission > 96 & hours_mission < 480) %>%
  count(year_of_mission)
```

```{r join--96-480-total}
join_96_480 <- full_join(astronauts_96_480, total_astronauts, by = "year_of_mission") %>%
  arrange(year_of_mission)

join_96_480[is.na(join_96_480)] <- 0 
prop96_480 <- join_96_480 %>%
  rename("number96_480" = n.x, total = n.y) %>%
  mutate(proportion96_480 = (number96_480 / total)) %>%
  select(year_of_mission, proportion96_480)
```

```{r mission-over-480h}
astronauts_480 <- astronauts %>%
  select(year_of_mission, hours_mission) %>%
  # mutate(total = sum(year_of_mission)) %>%
  filter(hours_mission > 480) %>%
  count(year_of_mission)
```

```{r join-three-tables}
join_480 <- full_join(astronauts_480, total_astronauts, by = "year_of_mission") %>%
  arrange(year_of_mission)

join_480[is.na(join_480)] <- 0 
prop_480 <- join_480 %>%
  rename("number480" = n.x, total = n.y) %>%
  mutate(proportion_480 = (number480 / total)) %>%
  select(year_of_mission, proportion_480)
```

```{r plotmissionhours, fig.cap="Proportion of space travelers in different spaceflights"}
mission <- full_join(prop_96, prop96_480, by = "year_of_mission") %>%
  full_join(prop_480, by = "year_of_mission") %>%
  rename("< 96h" = proportion_96, "96 to 480h" = proportion96_480, "> 480h" = proportion_480)

mission1 <- mission %>%
  pivot_longer("< 96h":"> 480h", names_to = "categories", values_to = "proportion") %>%
  mutate(categories = as_factor(categories)) %>%
  rename("Categories" = "categories")
# mutate(categories = fct_relevel(categories, c("96 to 480h", "> 480h", "< 96h")))

ggplot(mission1, aes(year_of_mission, proportion, Categories, fill = Categories)) +
  geom_bar(stat="identity",position="fill") +
  scale_fill_manual("Categories", values = c("96 to 480h" = "#F5B041", "< 96h" = "#F5CBA7", "> 480h" = "#D35400")) +
  ggtitle("Proportion of Space Travelers that Participated in Short, Intermediate and Long Spaceflights")+
  theme(panel.grid.major=element_line(colour=NA)) +
  xlab("Year") +
  ylab("Proportion of Astronauts") +
  theme(text = element_text(size = 9), axis.title.x = element_text(size = 12), axis.title.y = element_text(size = 12))
```

## Women performance in astronautical exploration

According to figure \@ref(fig:gender), while women have also appeared in space exploration, men have been the main force in this 49-year period. However, we cannot ignore the contribution of female astronaut in space exploration. @jacksona2019women indicated that women has preformed essential work in astronautical area since 19th century. Furthermore, @jacksona2019women also illustrated that the first women travelled into space was in 1963, and the first American female astronaut appeared in 1983. Female astronauts also contribute to the exploration same as male astronauts. 

```{r gender, fig.cap="Astronaut gender amount comparison"}
gender <- astronauts %>%
  select(year_of_mission,sex) %>% 
  group_by(year_of_mission) %>% 
  count(sex) 


gender %>% 
  ggplot() + 
  geom_bar(aes(sex, fill = sex)) + 
  xlab("gender") + 
  ggtitle("Astronaut Gender Amount") +
  theme_linedraw()+
  our_theme
```

Female astronauts trend to increase in the space exploration. According to figure \@ref(fig:gender-percentage), although there was female astronauts appears in the space in 1963, there was a 20-year empty period for female astronauts until 1981. Such situation finished until 1982, and after that, female astronauts trend to increase in fluctuation along with year growing. And female astronauts have appeared in the astronautical exploration almost every year. 

```{r gender-percentage, fig.cap="Global gender share in astronautical exploration of each year "}
astronauts %>% 
  select(year_of_mission, sex) %>% 
  ggplot() + 
  geom_bar(aes(x = year_of_mission, fill = sex), position = "fill") + 
  xlab("year") + 
  ggtitle("Global Gender Share") +
  theme_linedraw()+
  our_theme
``` 

Overall, female astronauts have started to appear frequently in the space exploration, and experienced a general increase tendency. However, female astronauts are still account for a low share compared with male astronauts. While, @jacksona2019women explained that the possibilities and need for more females in astronautical exploration have been considered in the worldwide nowadays. Female astronauts would trend to contribute more in the space exploration in the future, and more and more female might appear in the universe.

### Is there any female astronauts that have longer mission duration?

According to the \@ref(fig:gender) figure, we would like to explore more deeply the role of female astronauts in space missions. First of all, let us see how the female and male astronauts compare in total mission hour and extravehicular activity in space. If we look at Figure \@ref(fig:mission-hour-male-vs-female), two graphs show the comparison between the two. In general, female astronauts have less time than men, both on missions and extravehicular activity. The total number of days for men in (A) reaches almost 150,000 days while for women around 12,500 days. The same thing also happened to extravehicular activities (B) where the total days of women did not reach 100 days, but men were more than 500 days.

```{r mission-hour-male-vs-female, fig.cap="These two charts show the ratio of male and female astronauts in mission duration in days. The X-axis shows gender, while the y-axis shows the number of days. (A) By mission days, female have much lower duration than male, (B) In the total extravehicular activity, male have much longer to do the activity than female.", out.height="50%"}

library(patchwork) #load library patchwork to combine image
mission_hrs <- astronauts %>%
  #create new column day of mission
  mutate(day_of_mission = total_hrs_sum / 24) %>%
  # plot the data
  ggplot(aes(x = sex, y = day_of_mission, fill = sex)) +
  geom_col() +
  xlab("") +
  theme_linedraw() +
  # assign our theme
  our_theme +
  # add tag 
  labs(tag = "(A)", y = "Total Mission Length (in day)", color = "Sex")

eva_hrs <- astronauts %>%
   #create new column day of mission
  mutate(day_of_mission = total_eva_hrs / 24) %>%
  # plot the data
  ggplot(aes(x = sex, y = day_of_mission, fill = sex)) +
  geom_col() +
  xlab("") +
  theme_linedraw() +
  # assign our theme
  our_theme +
  # add tag
  labs(tag = "(B)", y = "Total Extravehicular Activity (in day) ", color = "Sex")

# combine the image together side by side with the tags
mission_hrs + eva_hrs + plot_layout(guides = "collect")
```

Next, we want to map each astronaut who has undergone a space mission based on mission duration, gender, and nationality. Figure \@ref(fig:astro-plotly) is an interactive plot that can be changed based on nationality. The x-axis shows the mission duration and the y-axis shows the name. Each point in this scatter plot represents one astronaut's name.


```{r astro-plotly, fig.cap="The interactive scatter plot with filter by nationality, x-axis shows mission duration in hours and y-axis represents name of the astronauts. Hover the point to look at the details of evry astronauts."}
# create the button attributes with restyle method from plotly
button_list <-
  lapply(1:length(unique(astronauts$nationality)), function(x) {
    list(
      method = "restyle",
      args = list(paste0("transforms[0].value"), unique(astronauts$nationality)[x]),
      label = unique(astronauts$nationality)[x]
    )
  })

# assign the model and layout of the button, here we used dropdown.
type_list <-  list(
  type = 'dropdown',
  active = -1,
  xanchor = 'right',
  yanchor = "top",
  pad = list('r' = 0, 't' = 10, 'b' = 10),
  x = 1.2,
  y = 1.2,
  buttons = button_list # assign button_list object to buttons
)

# the theme of y axis
axy <- list(
  title = "Name",
  zeroline = FALSE,
  showline = TRUE,
  showticklabels = FALSE,
  showgrid = FALSE
)
# the theme of x axis
axx <- list(
  title = "Total Mission in Hours",
  zeroline = FALSE,
  showline = TRUE,
  showticklabels = TRUE,
  showgrid = FALSE
)

# make scatter plot using plotly
plot_ly(
  astronauts,
  x = ~total_hrs_sum,
  y = ~name,
  # assign nationality column as object named customdata
  customdata=~nationality,
  type = "scatter",
  mode = "markers",
  # the point will be colored based on the sex
  color = ~sex,
  # assign color palletes
  colors = c("#FF6666", "#00CCCC"),
  # assign the info when hovering the point
   text = ~ paste('</br> Name: ',name,
                  '</br> Nationality: ',nationality,
                  '</br> Total Hours: ',total_hrs_sum),
   hoverinfo = "text",
  # assign the filter and the target
  transforms = list(
    list(
      type = 'filter',
      target = 'customdata',
      operation = '=',
      value = astronauts$nationality
    )
  )
) %>%
  # modify layout of the plot
  layout(updatemenus = list(type_list),
         xaxis = axx,
         yaxis = axy,
         title = "Every Single Astronaut's Time") %>%
  # hide the plotly ModeBar 
   config(displayModeBar = FALSE)

```


```{r female-mission}
# data for male vs male in mission duration
plot_mission <- astronauts %>%
  # group the data by name and summarised them by sex, nationality, and total hours
  group_by(name) %>%
  summarize(sex = sex,
            nationality = nationality,
            total_hrs_sum = total_hrs_sum) %>%
  unique() %>%
  # arrange from highest to lowest based on total hours
  arrange(desc(total_hrs_sum)) %>%
  # create the new variable day of mission by divide total hour with 24
  mutate(day_of_mission = total_hrs_sum / 24) %>%
  # only take 15 highest data
  head(15) %>%
  # plot the data
  ggplot(aes(
    x = fct_reorder(name, total_hrs_sum),
    y = day_of_mission,
    color = sex
  )) +
  geom_point(size = 2) +
  geom_segment(aes(
    x = name,
    xend = name,
    y = 0,
    yend = day_of_mission
  ), size = 1.2) +
  theme_linedraw() +
  ggtitle("Space Mission")+
  our_theme + 
  theme(legend.key = element_rect(fill = "#4e5a65"))+
  theme(plot.title.position = "plot")+
  ylab("Mission in days")+
  labs(tag = "(A)")+
  coord_flip()
  
```

```{r female-eva-mission}
# data for male vs male in eva duration
plot_eva <- astronauts %>%
  # group the data by name and summarised them by sex, nationality, and total hours
  group_by(name) %>%
  summarize(sex = sex,
            nationality = nationality,
            total_eva_hrs = total_eva_hrs) %>%
  unique() %>%
  # arrange from highest to lowest based on total hours
  arrange(desc(total_eva_hrs)) %>%
    # create the new variable day of mission by divide total hour with 24
  mutate(day_of_mission = total_eva_hrs / 24) %>%
    # only take 15 highest data
  head(15) %>%
  # plot the data
  ggplot(aes(
    x = fct_reorder(name, day_of_mission),
    y = day_of_mission,
    color = sex
  )) +
  geom_point(size = 2) +
  geom_segment(aes(
    x = name,
    xend = name,
    y = 0,
    yend = day_of_mission
  ), size = 1.2) +
  theme_linedraw() +
  ggtitle("Eva Activity")+
  our_theme +
  theme(legend.key = element_rect(fill = "#4e5a65"))+
  theme(plot.title.position = "plot")+
  ylab("Mission in days")+
  labs(tag = "(B)")+
  coord_flip()
```

From the interactive plot above, at a glance, we can see that there is a female astronaut who has a high enough mission time. Therefore, we will next present the 15 astronauts with the highest mission duration and spacewalk. In Figure \@ref(fig:astro-15) there are two plots A and B. Plot A shows the space mission while plot B shows extravehicular activity among astronauts. In Plot A, there is one female astronaut who is in ninth place, namely Peggy A. Whitson. Peggy has gone on space expeditions for a total of 665 days. Also, in plot B, we can see that Peggy is in fourth place in the spacewalk mission with a total time of 2.5 days. Another woman Astonot is Sunita L. Williams who is in tenth place. Sunita set out on a mission in 2006 and 2012 with a total extravehicular activity time of 2 days.

```{r astro-15, fig.cap="The lollipop graph that shows fifteen top astronauts based on mission times and extravehicular activity. (A) Whitson Peggy is the only female astronauts that sit on big nine in longest mission time, (B) Whitson Peggy and William SUnita are the only female astronauts that have more extravehicular activity in top fifteen", out.width="100%", out.height="60%"}
# combined the plots side by side
plot_mission+plot_eva+plot_layout(guides = "collect", heights = 100)
```

Peggy A. Whitson and Sunita L. Williams in Figure \@ref(fig:whitson-sunita), are American astronauts. Reported from @mars_peggy_2015, "Peggy completed two six-month tours of duty aboard the station for Expedition 5 in 2002, and as the station commander for Expedition 16 in 2008 where she accumulated 377 days in space between the two missions, the most for any US. woman at the time of her return to Earth." Another interesting fact from Peggy is that stated in @potter_record-setting_2018, in 2008, Whitson returned on Expedition 16 and became the first female commander of the space station. @potter_record-setting_2018 report that Peggy announced her retirement on June 16, 2018. 

@whiting_sunita_2016 explained that Sunita L Williams is a female astronaut selected by NASA in 1998 who has carried out two space missions Expeditions 14/15 and 32/33. Reported by @whiting_sunita_2016, now she is preparing for her third long-duration mission aboard the International Space Station. 

```{r whitson-sunita, fig.align='center', fig.cap=' **Left** : Peggy A. Whitson (Ph.D.), the U.S. record holder, placing eighth on the all-time space endurance list. **Right** : Sunita L. Williams, a veteran of two space missions Expeditions 14/15 and 32/33 (source:NASA)'}
library(imager)
# im <- load.image("data/whitson-sunita.png")
# plot(im, axes = 0)

library(png)
img <- readPNG("data/whitson-sunita.png")
grid::grid.raster(img)
```

Apart from Peggy and Sunita, there are many female astronauts from various countries who have carried out space missions. The rest can be seen in Table 3 below.

```{r}
library(DT)
library(htmltools)
# a custom table container
sketch = htmltools::withTags(table(
  class = 'display',
  thead(
    tr(
      th(colspan = 2, 'Profile'),
      th(colspan = 4, 'Mission Time'),
    ),
    tr(
      lapply(rep(c('Name','Sex','Nationality','Mission', 'Extravehicular'), 1), th)
    )
  )
))

astronauts %>%
  filter(sex=="female") %>%
  # group the data by name and summarised them by sex, nationality, and total hours
  group_by(name) %>%
  summarize(sex = sex,
            nationality = nationality,
            total_hrs_sum = total_hrs_sum,
            total_eva_hrs = total_eva_hrs) %>%
  unique() %>%
  # arrange from highest to lowest based on total hours
  arrange(desc(total_hrs_sum)) %>%
  datatable(class = 'cell-border stripe',
          container = sketch,
          rownames = FALSE,
          filter = 'top',
          selection="multiple",
          escape=FALSE,
          options = list(pageLength = 5, sDom  = '<"top">lrt<"bottom">ip'),
          caption = htmltools::tags$caption(style = 'caption-side: bottom; text-align: center;','Table 3: ',
                    em('List of Female Astronauts.')))
```

We want to see the background of the female astronaut in the dataset. In Figure \@ref(fig:figures-side) two graphs show a summary of the background of the female astronaut. In figure (A), astronauts with a civilian background dominate the military. A total of 106 came from civilian and 37 from the military.
Furthermore, in figure (B), 106 people who come from civilian are MSP (Mission Specialist). Based on @nasa_selection , Mission Specialists are working closely with the commander and pilot, are responsible for coordinating onboard operations involving crew activity planning.  Furthermore, 20 people were flight engineers, 7 were pilots, 3 were flight commander, and 5 were PSP (Payload Specialist). @nasa_selection stated that Payload Specialist is a professional in the physical or life sciences or a technician skilled in operating Shuttle-unique equipment. What is interesting about this plot is that there are two people who are Space Tourist.

They are Anousheh Ansari, an American businesswoman and Lee So Yeon from South Korea. Reported in @nasa_expedition, "American businesswoman Anousheh Ansari will fly with the Expedition 14 crew to the International Space Station as a spaceflight participant." @nasa_expedition explained that she spent nine days on the station under a commercial agreement with the Russian Federal Space Agency (Roscosmos) and returned to Earth with the Expedition 13 crew. In that expedition, she was with Sunita Williams on board.

Meanwhile based on @nasa_2012_international, Lee So Yeon is the first South Korean female astronaut to fly into space. Reported by NASA, she was selected from among 36,000 applicants to serve as her nation's first astronaut. @nasa_2012_international stated that she flew on Soyuz TMA-12 to the International Space Station (ISS) on April 8, 2008, returning to Earth 10 days later. 



```{r figures-side, fig.cap="The bar graph shows female astronauts background, (A) More astronauts comes from civilian than military fields, (B) MSP is a dominant occupation and there are small number of Space Tourist", fig.show="hold", out.width="50%"}
astronauts %>%
  filter(sex=="female") %>%
  group_by(sex, military_civilian) %>%
  tally() %>%
  ggplot(aes(x = military_civilian, y = n, fill = sex)) +
  geom_col()  + 
  theme_linedraw()+
  our_theme+
  theme(legend.position = "none")+
  ylab("")+
  xlab("")+
  labs(tag = "(A)", title = "Military Civilian Background")

astronauts$occupation[astronauts$occupation == "Other (space tourist)"] <-
  "Space Tourist"
astronauts$occupation[astronauts$occupation == "Space tourist"] <-
  "Space Tourist"
astronauts$occupation[astronauts$occupation == "Other (Space tourist)"] <-
  "Space Tourist"
astronauts$occupation <- tools::toTitleCase(astronauts$occupation)

astronauts %>%
  filter(sex=="female") %>%
  group_by(sex, occupation) %>%
  tally() %>%
  ggplot(aes(x = fct_reorder(occupation,n), y = n, fill = sex)) +
  geom_col()+
  theme_linedraw() +
  our_theme+
  ylab("")+
  xlab("")+
  labs(tags="(B)", title = "Occupation Background")
```


# Conclusions 

From the first humans have accomplished an orbital spaceflight in 1961 (@corlett2020population), to the intensity of launched reached a record figure in 1980s, the astronautical industry has experienced a continuous development. The interesting and enthusiasm of human for universe have prompted the development of astronautical industry. Whether based on the number of projects and missions launched for astronautical exploration, as well as the appearance of female astronauts and more countries join in the space exploration, the astronautical industry has showed the great development to human. 

The astronautical exploration projects and missions experienced a increase trend since the first humans appeared in the universe. And there were a space exploration rush lasted almost 24 years in the world. In that period, the number of project and mission are the highest level from 1961 to today. Meanwhile, many countries also join in the project of the astronautical exploration, which might contribute the development of the space exploration. 

Furthermore, the technologies of the space exploration also have developed. Through the spaceflight activities of space travelers exploration, the overall EVA number steadily increased ten years before, but it decreased in recent years. However, it does not mean the development of the spaceflights is regressing. Since the launch of the ISS program in 1998 (@NASA), the duration of almost each mission task is more than 480 hours.

In addition, female astronauts also appear in the history of astronautical exploration. Although male astronauts are still the main force in the universe, the number of female astronauts trend to increase from 20th century. And the appear of female astronauts might change the history of space exploration and help human with the exploration.


# Acknowledgement

The programming language used to analyse the trends of global astronautical exploration is R (4.0.2) [@R]. And the platform which used for running R language is Rstudio (1.3.1056) [@Rstudio].

Following packages has been included in our Rmd file.

- package tidyverse (1.3.0) [@tidyverse],
- package dplyr (1.0.1) [@dplyr],
- package plotly (4.9.2.1) [@plotly],
- package ggplot2 (3.3.2) [@ggplot2]


# References
